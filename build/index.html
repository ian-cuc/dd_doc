
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>钉钉开放平台</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <link href="stylesheets/nav.css" rel="stylesheet" type="text/css" media="nav" />
    <script src="./javascripts/jquery.min.js" type="text/javascript"></script>
      <script src="javascripts/all_nosearch.js" type="text/javascript"></script>
  </head>

  <body class="index">

	  <div class="navbar-container">
      <nav class="navbar"  id="top-nav">
        <a class="logo-container" href="/">
	      <div class="logo" style="font-family:'Microsoft Yahei','SimHe','SimSun'"></div>
	      </a>
        <ul>
          <li><a href="#概述">概述</a></li>
          <li><a href="#接入指南">接入指南</a></li>
          <li><a href="#服务端开发文档">服务端开发文档<b class="caret"></b></a>
          </li>
          <li><a href="#客户端开发文档">客户端开发文档<b class="caret"></b></a>
          </li>
          <li><a href="#faq">FAQ</a></li>
        </ul>
      </nav>
    </div>





    <a href="#" id="nav-button">
      <span>
        菜单
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="概述">概述</h1>

<p>开发者还可以通过钉钉开放平台提供的接口，实现更多丰富且个性化的企业移动微应用。微应用是钉钉为连接企业办公打造的移动入口，通过微应用可以将企业的业务审批，内部系统，人员协作与管理，客户关系管理等连接到钉钉，实现企业的办公移动化。结合钉钉的基础通信能力，降低办公成本，提高工作效率和企业应用活跃度。</p>

<p>开发者可以通过以下方式了解更多关于钉钉开放平台的消息：</p>

<ul>
<li><a href="http://bbs.aliyun.com/thread/276.html?spm=5176.7189909.0.0.bq46VP">开发者论坛</a></li>
<li>邮件组: open-dingtalk@list.alibaba-inc.com</li>
<li>钉钉开放平台官方技术答疑群：</li>
</ul>

<p><img alt="chat_qrcode" src="https://img.alicdn.com/tps/TB1piXHIVXXXXX3XVXXXXXXXXXX.jpg" /></p>

          <h1 id="接入指南">接入指南</h1>

<p>钉钉开放平台提供了企业通讯录管理、文件管理、发送企业会话消息等功能，接口使用可以参考<a href="http://open.dingtalk.com/#服务端开发文档">服务端开发文档</a>；</p>

<p>我们定制了微应用专用的运行容器，提供了一组可以调用钉钉的原生控件和业务逻辑的JS接口，开发者可以通过这些接口使用钉钉中定制的原生控件或者复用钉钉原有的业务逻辑，降低开发成本，提高微应用在移动客户端的体验。接口使用可以参考<a href="http://open.dingtalk.com/#客户端开发文档">客户端开发文档</a>。</p>

<p>该指南主要介绍了企业和ISV如何接入钉钉开放平台，其中涉及到接入过程中使用的工具、与钉钉开放平台相关的概念和接入钉钉开放平台的一些实践方法，以帮助开发者快速开发自己的微应用。</p>

<h2 id="企业接入">企业接入</h2>

<p>企业接入指南重点介绍使用钉钉开放平台的开发微应用的流程，帮助企业快速接入钉钉开放平台。该节主要分为四个部分：第一部分介绍企业接入钉钉开放平台的准备工作；第二部介绍如何访问开放平台服务端接口；第三部分介绍钉钉开放平台提供的员工身份验证流程；第四部分介绍发送消息到微应用会话。</p>

<p><br /></p>

<h3 id="开发环境准备">开发环境准备</h3>

<p>开发者在使用钉钉开放平台开发微应用前需做好以下准备：</p>

<ul>
<li>获取钉钉开放平台开发者信息；</li>
<li>服务端环境搭建和域名注册；</li>
<li>开发环境搭建；</li>
</ul>

<p>开发者可以从 <strong><a href="https://oa.dingtalk.com">钉钉管理后台</a></strong> 获取必要的信息用于微应用开发，还可以利用该系统完成微应用配置相关的工作；开发者可以自己搭建服务器也可以购买云主机来搭建自己的服务端环境，开发者需要为自己的微应用注册合法有效的域名并配置在 <strong><a href="https://oa.dingtalk.com/#/microApp/microAppList">应用中心</a></strong> ；钉钉开放平台的服务端接口不区分语言和平台，开发者可以使用自己熟悉的技术搭建开发环境来开发微应用。</p>

<p><strong><a href="https://oa.dingtalk.com">钉钉管理后台</a></strong> 系统为企业提供了企业通讯录管理、微应用、安全中心、员工数据统计和系统常用设置等功能。</p>

<p><img alt="oa_system.jpg" src="https://img.alicdn.com/tps/TB1rH0DIVXXXXadXXXXXXXXXXXX.jpg" /></p>

<p><strong>钉钉管理后台管理员（以下简称钉钉后台管理员）</strong> 在企业通讯录管理页面可以完成企业的组织结构和员工个人信息的添加、删除、查看和修改等操作；在微应用管理页面可以完成添加和删除微应用，获取CorpID和CorpSecret(接入钉钉开放平台的凭证)，查看微应用相关信息，管理微应用的运行状态等。开发者在使用该系统前需要注册成为钉钉后台管理员或者由钉钉后台管理员分配管理员子帐号。</p>

<h4 id="钉钉后台管理员注册">钉钉后台管理员注册:</h4>

<p>一、进入 <strong><a href="https://oa.dingtalk.com">钉钉管理后台</a></strong> 页面, 点击 <strong><a href="https://oa.dingtalk.com/register.html?spm=0.0.0.0.dL51oc">企业注册</a></strong>；</p>

<p><img alt="enterprise_register_entry" src="https://img.alicdn.com/tps/TB14kI8IFXXXXciapXXXXXXXXXX.jpg" /></p>

<p>二、填写注册手机号码和短信验证码；</p>

<p>三、输入企业基本信息和管理员帐号和密码，点击 <em>注册</em> 按钮完成注册过程。</p>

<p><img alt="input_enterprise_info" src="https://img.alicdn.com/tps/TB1b74tIVXXXXXaXFXXXXXXXXXX.jpg" /></p>

<aside class="notice">
通过钉钉移动客户端创建的企业默认没有设置钉钉后台管理员，需要通过以上流程注册管理员帐号。
</aside>

<h4 id="分配管理员子账号：">分配管理员子账号：</h4>

<p>一、登录钉钉后台管理系统，按下图进入安全中心的添加管理员子帐号页面；</p>

<p><img alt="add_sub_manager" src="https://img.alicdn.com/tps/TB1ItRLIVXXXXauXXXXXXXXXXXX.jpg" /></p>

<p>二、按下图提示填写子帐号信息</p>

<p><img alt="set_sub_manager_account" src="https://img.alicdn.com/tps/TB1S.JwIVXXXXcVXpXXXXXXXXXX.jpg" /></p>

<p>完成管理员子帐号设置后，子帐号关联的钉钉用户会在钉钉客户端的 <em>钉小秘</em> 会话中收到管理员帐号和初始密码，该钉钉用户可以通过收到的帐号和密码登录 <strong><a href="https://oa.dingtalk.com">钉钉管理后台</a></strong> 进入安全中心对初始密码进行修改。</p>

<h4 id="微应用管理">微应用管理</h4>

<p>登录钉钉管理后台后可以进入 <em>应用中心</em> 页面对微应用进行运行状态管理，进入微应用后台，微应用信息查看与设置，微应用添加和删除等操作。</p>

<p><img alt="enter_microapp_center" src="https://img.alicdn.com/tps/TB1jXVyIVXXXXaLXFXXXXXXXXXX.jpg" /></p>

<p>点击 <em>新增微应用</em> 按钮，按下图填写微应用信息，点击确定后可以新增微应用。</p>

<p><img alt="add_micro_app" src="https://img.alicdn.com/tps/TB19fVHIVXXXXbXXFXXXXXXXXXX.jpg" /></p>

<p><em>首页地址</em> : 以<code class="prettyprint">http://</code>或者<code class="prettyprint">https://</code> 开头的URL，是微应用的首页地址；在移动设备上打开微应用Tab页，点击微应用列表中的微应用将访问这个URL指向的页面。</p>

<p><em>后台地址</em> : 以<code class="prettyprint">http://</code>或者<code class="prettyprint">https://</code> 开头的URL，是微应用的后台管理页面地址；配置后台地址后可以通过应用中心页面进入到微应用的管理后台。</p>

<aside class="notice">
<b>首页地址</b> 的URL域名务必保证真实有效，否则会导致钉钉用户无法正常使用微应用。
</aside>

<p>每个微应用都有 <em>设置</em> 选项，点击后进入微应用的设置页面，开发者可以在这里修改微应用的常用信息设置</p>

<p><img alt="get_micro_app_agentID" src="https://img.alicdn.com/tps/TB1sOhPIVXXXXcyXpXXXXXXXXXX.jpg" /></p>

<p>开发者在应用中心创建微应用后，如上图所示可获取到微应用的AgentID，AgentID可用于发送企业会话消息等场景。</p>

<p>开发者完成以上准备工作后就可以进入开发阶段。</p>

<p><br /></p>

<h3 id="调用平台接口">调用平台接口</h3>

<p>开发者在调用钉钉开放平台接口时需要附加AccessToken，AccessToken可以通过CorpID和CorpSecret获取。</p>

<h4 id="获取corpid和corpsecret">获取CorpID和CorpSecret</h4>

<p>CorpID是企业的唯一标识，获取CorpID和CorpSecret的步骤如下:</p>

<p>一、使用管理员帐号登录 <strong><a href="https://oa.dingtalk.com">钉钉管理后台</a></strong> ；</p>

<p>二、选择顶部菜单 <strong>微应用</strong> 进入微应用页面，在左侧菜单选择 <strong>微应用设置</strong> 进入微应用设置页；</p>

<p>三、在微应用设置页面底部点击 <strong>获取</strong> 按钮即可获取CorpID和CorpSecret。</p>

<p><img alt="get_scecret_corpId" src="https://img.alicdn.com/tps/TB1k6hoIVXXXXcXapXXXXXXXXXX.jpg" /></p>

<aside class="notice">
钉钉开放平台提供了获取和修改企业(团队)的组织结构信息、人员信息等功能，所以请妥善保管CorpID和CorpSecret，避免外泄影响企业信息安全。
</aside>

<h4 id="获取accesstoken">获取AccessToken</h4>

<p>开发者在调用开放平台接口前需要通过CorpID和CorpSecret获取AccessToken。获取AccessToken的方法是向 <code class="prettyprint">https://oapi.dingtalk.com/gettoken?corpid=id&amp;corpsecret=secrect</code> GET请求。</p>

<p>开发者获取AccessToken后便可以调用开放平台其他接口。</p>

<p>以获取部门列表接口为例，获取部门列表接口为：</p>

<p><code class="prettyprint">oapi.dingtalk.com/department/list</code></p>

<p>在请求该接口时，需要将获取的AccessToken作为请求参数拼装到URL中：</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/list?access_token=ACCESS_TOKEN</code></p>

<p>更多关于AccessToken的信息请参考<a  href="http://open.dingtalk.com/#建立连接">《服务端开发文档-建立连接》</a>一节。</p>

<p><br /></p>

<h3 id="使用免登服务">使用免登服务</h3>

<p>钉钉开放平台提供了身份验证接口，用于验证当前访问微应用用户的身份信息。用户在钉钉客户端使用微应用不需输入帐号和密码，提高微应用的使用体验与安全性。微应用免登过程如下图所示：</p>

<p><img alt="OAuth" src="https://img.alicdn.com/tps/TB12f4SIVXXXXXdaVXXXXXXXXXX.png" /></p>

<p>微应用的页面加载时需要进行用户身份验证，我们推荐开发者使用Cookie技术降低调用钉钉开放平台验证用户身份接口的次数避免不必要的加载页面的时间开销。</p>

<ol>
<li>用户在钉钉客户端中发起访问微应用页面的请求（假设此微应用的首页地址为：https://www.abc.com/oa），浏览器会自动将与首页地址域名相关的Cookie附加在请求中一起发送到微应用服务器；</li>
<li>微应用服务器通过请求的Cookie判断用户身份，若成功判断用户身份且用户有权访问请求的页面则将页面内容返回并结束用户身份验证流程；否则，判断请求中是否有code和state参数，若无code和state参数进入第3步，否则进入第9步；</li>
<li>生成STATE码，STATE可以使用a-zA-Z0-9，长度不超过128个字节，建议开发者将STATE码使用Cookie或者Session的方式标记该次请求；</li>
<li>构造302响应，指定响应头的Location字段值为 <code class="prettyprint">https://oapi.dingtalk.com/connect/oauth2/authorize?appid=CORPID&amp;redirect_uri=https://www.abc.com/oa&amp;response_type=code&amp;scope=snsapi_base&amp;state=STATE#ding_redirect</code> appid是企业的CorpID；redirect_uri是要重定向的链接地址，这里指向第1步访问微应用页面的地址，需要做URL编码处理；response_type与scope为定值分别为code和snsapi_base；state是第3步生成的STATE码；将构造好的响应消息返回给微应用Web容器；</li>
<li>微应用Web容器根据第4步的响应向Location字段标识的地址请求获取userID的授权码；</li>
<li> 钉钉开发平台服务器验证微应用页面地址合法性以及当前进行请求的钉钉用户属于当前企业，如果不通过则返回错误提示页面并结束用户身份验证流程；否则，生成获取userID的授权码CODE；</li>
<li>构造302响应，响应头的Location字段值为https://www.abc.com/oa?code=CODE&amp;state=STATE，code为第6步生成的临时授权码，state为第5步请求中URL的state参数值，将请求重定向到第1步用户在钉钉客户端中发起访问微应用页面；</li>
<li>用户在钉钉客户端中再次发起访问微应用页面的请求；</li>
<li>若此时微应用服务有AccessToken，则进入第11步，否则应当向钉钉开发平台请求AccessToken（获取方法参考<a href="http://open.dingtalk.com/#调用平台接口">调用平台接口</a>）；</li>
<li>请求合法返回AccessToken，否则返回错误页面结束结束身份验证；</li>
<li>根据请求中的state判断这次请求的合法性，若为非法访问则返回错误页面，结束用户身份验证流程；否则向钉钉开放平台请求userID，构造的请求为 <code class="prettyprint">https://oapi.dingtalk.com/user/getuserinfo?access_token=AccessToken&amp;code=CODE</code>，access_token是第9步获取的AccessToken ；code是第7步生成的临时授权码；</li>
<li>根据AccessToken和CODE生成userID并返回；若AccessToken非法则进入第9步，若CODE非法则返回错误信息，微应用服务器根据错误信息重新处理或者结束身份验证流程；</li>
<li>微应用服务器获取userID根据内部业务逻辑判断是否可以允许用户访问该微应用页面；若允许则进入第14步，否则返回错误信息结束身份验证流程；</li>
<li>返回微应用页面；推荐开发者在这里设置Cookie用于避免该用户再次访问同一个页面时触发免登身份验证流程；将STATE做失效处理。</li>
</ol>

<p>详细文档请参阅<a href="http://open.dingtalk.com/#免登服务">服务端开发文档 - 免登服务</a>。</p>

<aside class="notice">
其中STATE要保证随机生成，尽量避免重复，并且推荐开发者使用以防止CSRF攻击。
</aside>

<p><br /></p>

<h3 id="发送企业会话消息">发送企业会话消息</h3>

<p>用户可以在企业会话中查看微应用发送的消息，开发者可以通过发送消息接口将消息发送到企业会话中。</p>

<p><img alt="send_micro_app_message" src="https://img.alicdn.com/tps/TB1LvU_IpXXXXa_XFXXXXXXXXXX.jpg" /></p>

<p>调用消息发送接口时需要使用<code class="prettyprint">HTTPS</code>协议，发送的数据包为<code class="prettyprint">JSON</code>格式。目前钉钉开放平台支持文本、图片、声音、文件、链接、办公消息等消息类型。</p>

<h3 id="示例程序">示例程序</h3>

<p>在<a href="http://open.dingtalk.com/#demo">《Open API - 代码示例》</a>的Java版本中有发送消息的代码演示，开发者可以下载参考。</p>

<p>如果在使用开放平台中遇到困难请浏览<a href="http://open.dingtalk.com/#faq">《Open API - 常见问题》</a>一节，若仍不能解决请按概述中的提供的反馈方式联系我们。</p>

<h2 id="合作伙伴接入">合作伙伴接入</h2>

<h3 id="钉钉isv（服务提供商）应用授权和接口说明">钉钉ISV（服务提供商）应用授权和接口说明</h3>

<p>欢迎成为钉钉微应用的应用提供商！
通过接入钉钉ISV的应用授权接口，可以快速发布自己的微应用套件，引导企业客户自动开通微应用，将自己的服务快速触达到自己的目标客户！
钉钉的应用授权方案包含以下两个场景：</p>

<h4 id="1-isv注册应用">1.ISV注册应用</h4>

<p>你，作为ISV若要使用此方案，只需注册成为第三方应用提供商（前期请直接联系钉钉运营人员或发邮件申请成为ISV开发者），在ISV接入后台创建应用套件，并在应用套件中配置好相应的应用。
本方案所说的应用套件，是第三方应用授权的主体，它可以包含多个第三方所提供的同一类型的应用。目前一个第三方最多可以注册五个应用套件，一个应用套件最多可以包含五个应用。</p>

<h4 id="2-企业管理员授权应用">2.企业管理员授权应用</h4>

<p>企业的管理员在钉钉企业后台的微应用列表中浏览你的应用套件后，即可发起一键授权，系统将展示微应用的第三方授权页面，管理员根据授权页面的引导，确认授权内容，完成授权操作。
授权完成之后，企业就可使用ISV应用提供商所提供的应用服务了。一切将变得简单自然。以下是详细的接口调用时序图</p>

<p><img alt="Mou icon" src="https://img.alicdn.com/tps/TB1jWcaIFXXXXa5XpXXXXXXXXXX.png" /></p>

<h3 id="1-注册成为第三方应用提供商">1:注册成为第三方应用提供商</h3>

<p>需要提供的数据项：</p>

<table><thead>
<tr>
<th>信息项</th>
<th>要求及说明</th>
</tr>
</thead><tbody>
<tr>
<td>企业Logo</td>
<td>应用提供商的企业Logo，小于2M，640*240，背景为白色</td>
</tr>
<tr>
<td>企业简称</td>
<td>使用对外宣传的企业简称，能代表企业的名字，2-16个字</td>
</tr>
<tr>
<td>企业简介</td>
<td>描述企业所提供的服务，4-120个字</td>
</tr>
<tr>
<td>企业官网</td>
<td>应用服务商的企业官网</td>
</tr>
</tbody></table>

<h3 id="2-创建应用套件和微应用">2:创建应用套件和微应用</h3>

<p>需要提供的数据项：</p>

<table><thead>
<tr>
<th>信息项</th>
<th>要求及说明</th>
</tr>
</thead><tbody>
<tr>
<td>服务事件接收URL</td>
<td>系统将会把此套件的授权变更事件以及ticket参数推送给此URL。(ticket说明详见API接口说明)</td>
</tr>
<tr>
<td>Token</td>
<td>可任意填写，用于生成签名,校验回调请求的合法性。后续所有托管的企业产生的回调消息都使用该值来解密。</td>
</tr>
<tr>
<td>EncodingAESKey</td>
<td>回调消息加解密参数，是AES密钥的Base64编码，用于解密回调消息内容对应的密文。后续所有托管的企业产生的回调消息都使用该值来解密。</td>
</tr>
<tr>
<td>白名单IP列表</td>
<td>应用套件调用第三方应用API时的合法IP列表，只有白名单内的IP才能正常调用API，后续IP若有修改，需要及时进行列表更新。</td>
</tr>
<tr>
<td>套件logo图片</td>
<td>png格式</td>
</tr>
<tr>
<td>套件介绍网站</td>
<td>128字符以内</td>
</tr>
<tr>
<td>套件描述</td>
<td>120字符以内</td>
</tr>
<tr>
<td>套件试用行业</td>
<td>16字符以内</td>
</tr>
<tr>
<td>套件关键词标签</td>
<td>16字符以内</td>
</tr>
</tbody></table>

<p>创建应用的基本信息：</p>

<table><thead>
<tr>
<th>信息项</th>
<th>要求及说明</th>
</tr>
</thead><tbody>
<tr>
<td>应用Logo</td>
<td>应用的Logo，小于2M，640*240，在授权页会被用于展示。</td>
</tr>
<tr>
<td>应用名称</td>
<td>应用的名称，2-16个字。</td>
</tr>
<tr>
<td>功能介绍</td>
<td>描述该应用的功能与特色，4-120个字内</td>
</tr>
</tbody></table>

<p>开发信息：</p>

<table><thead>
<tr>
<th>应用参数内容</th>
<th>要求及说明</th>
</tr>
</thead><tbody>
<tr>
<td>callbackurl</td>
<td>用于接收托管企业应用的用户消息，URL支持使用$CORPID$模板参数表示corpid，推送事件时会替换为企业的corpid。</td>
</tr>
<tr>
<td>特殊权限</td>
<td>应用的特殊权限为上报地理位置的功能开关，若在创建应用时勾选了此特殊权限，在授权会提示用户。</td>
</tr>
</tbody></table>

<h3 id="3-回调接口（分为三个回调类型）">3: 回调接口（分为三个回调类型）</h3>

<p>https://127.0.0.1/suite/receive?msg_signature=3a7b08bb8e6dbce3c9671d6fdb69d15066227608
&amp;timestamp=1403610513&amp;nonce=380320359</p>

<h4 id="a-定时推送ticket">a: 定时推送Ticket</h4>

<p>服务器会向应用提供商申请时填写的套件事件接收 URL定时（二十分钟）推送ticket：</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"SuiteKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dingxxxxxx"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"suite_ticket "</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234456</span><span class="p">,</span><span class="w">
  </span><span class="nt">"SuiteTicket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"adsadsad"</span><span class="p">,</span><span class="w">
</span><span class="err">}</span><span class="w">
</span></code></pre>

<p>应用提供商在收到ticket推送后需要返回字符串success。</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SuiteKey</td>
<td>应用套件的SuiteKey</td>
</tr>
<tr>
<td>InfoType</td>
<td>suite_ticket</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>SuiteTicket</td>
<td>Ticket内容</td>
</tr>
</tbody></table>

<h4 id="b-回调向isv推送临时授权码">b:回调向ISV推送临时授权码</h4>

<p>当授权方（即授权企业）在微应用管理端的授权管理中，向应用提供商的应用套件授权了访问权限，钉钉服务器会向应用提供商的套件事件接收 URL（创建套件时填写）推送临时授权码</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"SuiteKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dingxxxxxx"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">" tmp_auth_code"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234456</span><span class="p">,</span><span class="w">
  </span><span class="nt">"AuthCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"adads"</span><span class="p">,</span><span class="w">
</span><span class="err">}</span><span class="w">
</span></code></pre>

<p>应用提供商在收到推送消息后需要返回字符串success</p>

<p>字段说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SuiteKey</td>
<td>应用套件的SuiteKey</td>
</tr>
<tr>
<td>EventType</td>
<td>change_auth</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>AuthCode</td>
<td>临时授权码</td>
</tr>
</tbody></table>

<h4 id="c-回调向isv通知授权设置变更">c:回调向ISV通知授权设置变更</h4>

<p>当授权方（即授权企业）在微应用管理端的授权管理中，修改了对套件方的授权托管后，钉钉服务器会向应用提供商的套件事件接收 URL（创建套件时填写）推送变更授权通知。</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"SuiteKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dingxxxxxx"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">" change_auth"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234456</span><span class="p">,</span><span class="w">
  </span><span class="nt">"AuthCorpId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxxx"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>应用提供商在收到推送消息后需要返回字符串success</p>

<p>字段说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SuiteKey</td>
<td>应用套件的SuiteKey</td>
</tr>
<tr>
<td>EventType</td>
<td>change_auth</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>AuthCorpID</td>
<td>授权方企业的corpid</td>
</tr>
</tbody></table>

<h3 id="4-获取套件访问token（suite_access_token）">4: 获取套件访问Token（suite_access_token）</h3>

<p>该API用于获取应用套件令牌（suite_access_token）</p>

<p>接口调用请求说明
https请求方式: POST
https://oapi.dingtalk.com/service/get_suite_token</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"suite_key"</span><span class="p">:</span><span class="s2">"key_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"suite_secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"secret_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"suite_ticket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ticket_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_key</td>
<td>应用套件的key</td>
</tr>
<tr>
<td>suite_secret</td>
<td>应用套件secret</td>
</tr>
<tr>
<td>suite_ticket</td>
<td>钉钉后台推送的ticket</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"suite_access_token"</span><span class="p">:</span><span class="s2">"61W3mEpU66027wgNZ_MhGHNQDHnFATkDa9-2llqrMBjUwxRSNPbVsMmyD-yq8wZETSoE5NQgecigDrSHkPtIYA"</span><span class="p">,</span><span class="w">  </span><span class="nt">"expires_in"</span><span class="p">:</span><span class="mi">7200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_access_token</td>
<td>应用套件access_token</td>
</tr>
<tr>
<td>expires_in</td>
<td>有效期</td>
</tr>
</tbody></table>

<h3 id="5-获取企业的永久授权码">5: 获取企业的永久授权码</h3>

<p>该API用于使用临时授权码换取授权方的永久授权码，并换取授权信息、企业access_token。</p>

<p>注：临时授权码使用一次后即失效</p>

<p>接口调用请求说明
https请求方式: POST
https://oapi.dingtalk.com/service/get_permanent_code?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"tmp_auth_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">" value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>tmp_auth_cod</td>
<td>回调接口（tmp_auth_code）获取的临时授权码</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"auth_corp_info"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"corpid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxx"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"corp_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
    </span><span class="err">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>permanent_code</td>
<td>永久授权码</td>
</tr>
<tr>
<td>corp_info</td>
<td>授权方企业信息</td>
</tr>
<tr>
<td>corpid</td>
<td>授权方企业id</td>
</tr>
<tr>
<td>corp_name</td>
<td>授权方企业名称</td>
</tr>
</tbody></table>

<h3 id="6-获取企业授权的access_token">6:获取企业授权的access_token</h3>

<p>应用提供商在取得企业的永久授权码并完成对企业应用的设置之后，便可以开始通过调用企业接口来运营这些应用。其中，调用企业接口所需的access_token获取方法如下。</p>

<p>接口调用请求说明</p>

<p>https请求方式: POST
https://oapi.dingtalk.com/service/get_corp_token?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"code_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，通过get_permanent_code获取</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">7200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>授权方（企业）access_token</td>
</tr>
<tr>
<td>expires_in</td>
<td>授权方（企业）access_token超时时间</td>
</tr>
</tbody></table>

<h3 id="7-获取企业授权的授权数据">7:获取企业授权的授权数据</h3>

<p>该API用于通过永久授权码换取授权信息。 永久code的获取，是通过临时授权码使用get_permanent_code 接口获取到的permanent_code。</p>

<p>接口调用请求说明</p>

<p>https请求方式: POST</p>

<p>https://oapi.dingtalk.com/service/get_auth_info?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="s2">"code_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"suite_id"</span><span class="p">:</span><span class="s2">"id_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_id</td>
<td>应用套件id</td>
</tr>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，通过get_permanent_code获取</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"auth_corp_info"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"corp_logo_url"</span><span class="p">:</span><span class="s2">"http://xxxx.png"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"corp_name"</span><span class="p">:</span><span class="s2">"corpid"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"auth_info"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"agent"</span><span class="p">:[{</span><span class="w">
            </span><span class="nt">"agent_name"</span><span class="p">:</span><span class="s2">"aaaa"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"appid"</span><span class="p">:</span><span class="mi">-3</span><span class="p">,</span><span class="w">
            </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="s2">"http://aaaaaa.com"</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="p">,{</span><span class="w">
            </span><span class="nt">"agent_name"</span><span class="p">:</span><span class="s2">"bbbb"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w">
            </span><span class="nt">"appid"</span><span class="p">:</span><span class="mi">-2</span><span class="p">,</span><span class="w">
            </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="s2">"http://vvvvvv.com"</span><span class="w">
    </span><span class="p">}]</span><span class="w">
    </span><span class="p">},</span><span class="w">
          </span><span class="nt">"errcode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>auth_corp_info</td>
<td>授权方企业信息</td>
</tr>
<tr>
<td>corpid</td>
<td>授权方企业id</td>
</tr>
<tr>
<td>corp_name</td>
<td>授权方企业名称</td>
</tr>
<tr>
<td>corp_logo_url</td>
<td>企业logo</td>
</tr>
<tr>
<td>auth_info</td>
<td>授权信息</td>
</tr>
<tr>
<td>agent</td>
<td>授权的应用信息</td>
</tr>
<tr>
<td>agentid</td>
<td>授权方应用id</td>
</tr>
<tr>
<td>agent_name</td>
<td>授权方应用名字</td>
</tr>
<tr>
<td>logo_url</td>
<td>授权方应用头像</td>
</tr>
<tr>
<td>appid</td>
<td>服务商套件中的对应应用id</td>
</tr>
</tbody></table>

<h3 id="8-获取企业的应用信息">8:获取企业的应用信息</h3>

<p>该API用于获取授权方的企业的某个应用的基本信息，包括LOGO,名称，描述等,信息接口调用请求说明</p>

<p>https请求方式: POST</p>

<p>https://oapi.dingtalk.com/service/get_agent?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">541</span><span class="p">,</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="s2">"code_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"suite_id"</span><span class="p">:</span><span class="s2">"id_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_id</td>
<td>应用套件id</td>
</tr>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，从get_permanent_code接口中获取</td>
</tr>
<tr>
<td>agentid</td>
<td>授权方应用id</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">541</span><span class="p">,</span><span class="w">
    </span><span class="nt">"close"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"企业重要消息"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="s2">"http://xxxxxxx/png"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"公告"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>agentid</td>
<td>授权方企业应用id</td>
</tr>
<tr>
<td>name</td>
<td>授权方企业应用名称</td>
</tr>
<tr>
<td>logo_url</td>
<td>授权方企业应用头像</td>
</tr>
<tr>
<td>description</td>
<td>授权方企业应用详情</td>
</tr>
<tr>
<td>close</td>
<td>授权方企业应用是否被禁用</td>
</tr>
</tbody></table>

<h3 id="9-激活授权套件">9:激活授权套件</h3>

<p>该API用于激活授权方企业的套件微应用,信息接口调用请求说明</p>

<p>https请求方式: POST</p>

<p>https://oapi.dingtalk.com/service/activate_suite?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"suite_id"</span><span class="p">:</span><span class="s2">"id_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="s2">"permanent_code"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_id</td>
<td>应用套件id</td>
</tr>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，从get_permanent_code接口中获取</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="10-加解密方案">10: 加解密方案</h3>

<p>开启回调模式时，有以下术语需要了解：</p>

<ol>
<li><p>msg_signature是签名，用于验证调用者的合法性。具体算法见以下&#39;消息体签名&#39;章节</p></li>
<li><p>EncodingAESKey用于消息体的加密，长度固定为43个字符，从a-z, A-Z, 0-9共62个字符中选取，是AESKey的Base64编码。解码后即为32字节长的AESKey</p></li>
<li><p>AESKey=Base64_Decode(EncodingAESKey + “=”)，是AES算法的密钥，长度为32字节。AES采用CBC模式，数据采用PKCS#7填充；IV初始向量大小为16字节，取AESKey前16字节。具体详见：http://tools.ietf.org/html/rfc2315</p></li>
<li><p>msg为消息体明文，格式为XML</p></li>
<li><p>msg_encrypt = Base64_Encode( AES_Encrypt[random(16B) + msg_len(4B) + msg + $CorpID] )，是对明文消息msg加密处理后的Base64编码。其中random为16字节的随机字符串；msg_len为4字节的msg长度，网络字节序；msg为消息体明文；$CorpID为isv的标识</p></li>
</ol>

<h3 id="消息体签名">消息体签名</h3>

<p>为了验证调用者的合法性，钉钉在回调url中增加了消息签名，以参数msg_signature标识，企业需要验证此参数的正确性后再解密。</p>

<p>验证步骤：</p>

<ol>
<li><p>企业计算签名：dev_msg_signature=sha1(sort(token、timestamp、nonce、msg_encrypt))。sort的含义是将参数按照字母字典排序，然后从小到大拼接成一个字符串</p></li>
<li><p>比较dev_msg_signature和msg_signature是否相等，相等则表示验证通过</p></li>
</ol>

<p>在被动响应消息时，企业同样需要用如上方法生成签名并传给钉钉</p>

<h5 id="加解密方案说明">加解密方案说明</h5>

<h6 id="对明文msg加密的过程如下：">对明文msg加密的过程如下：</h6>

<p>msg_encrypt = Base64_Encode( AES_Encrypt[random(16B) + msg_len(4B) + msg + $CorpID] )
AES加密的buf由16个字节的随机字符串、4个字节的msg长度、明文msg和$CorpID组成。其中msg_len为msg的字节数，网络字节序；$CorpID为isv的CorpID。经AESKey加密后，再进行Base64编码，即获得密文msg_encrypt。</p>

<h5 id="对应于加密方案，解密方案如下：">对应于加密方案，解密方案如下：</h5>

<ul>
<li>对密文BASE64解码：aes_msg=Base64_Decode(msg_encrypt)</li>
<li>使用AESKey做AES解密：rand_msg=AES_Decrypt(aes_msg)</li>
<li>验证解密后$CorpID、msg_len</li>
<li>去掉rand_msg头部的16个随机字节，4个字节的msg_len,和尾部的$CorpID即为最终的消息体原文msg</li>
</ul>

          <h1 id="服务端开发文档">服务端开发文档</h1>

<p>欢迎你，钉钉微应用的开发者，我们很期待你成为钉钉微应用的开发者；</p>

<p>微应用是 钉钉 为连接企业办公打造的移动入口，通过微应用你可以将企业的业务审批，内部系统，生成，协作，管理，上下游沟通连接到钉钉，更简单和低成本实现企业移动化； 结合钉钉的基础通信能力，让企业应用更活跃，员工更高效，移动化成本更低。</p>

<p>此文档很适合于:</p>

<ol>
<li><p>企业的IT部，了解钉钉如何连接你所在企业的办公；</p></li>
<li><p>软件开发服务商，了解如何通过钉钉为您的客户提供定制的企业办公软件，提升你的服务价值。</p></li>
</ol>

<h2 id="建立连接">建立连接</h2>

<p>你可以使用以下三种方式，将钉钉微应用连接到你的企业应用：</p>

<ol>
<li><p>企业应用服务器调用钉钉开放平台提供的接口，以钉钉微应用的身份给企业用户的钉钉账号推送消息，以下称 <strong>主动调用模式</strong>。</p></li>
<li><p>钉钉用户在使用企业提供的微应用H5页面时，该页面可以调用钉钉提供的原生接口，使用钉钉开放的终端能力，以下称 <strong>JSAPI模式</strong>。</p></li>
</ol>

<h3 id="主动调用">主动调用</h3>

<p>当企业应用服务器调用钉钉开放平台接口时，需使用https协议、Json数据格式、UTF8编码，访问域名为 https://oapi.dingtalk.com。
在每次主动调用钉钉开放平台接口时需要带上AccessToken参数。AccessToken参数由CorpID和CorpSecret换取。</p>

<p>CorpID是企业在钉钉中的标识，每个企业拥有一个唯一的CorpID；</p>

<p>CorpSecret是企业每个应用的凭证密钥。</p>

<p>CorpID及CorpSecret可以在钉钉为企业提供的管理后台中找到，由钉钉自动分配。</p>

<aside class="notice">
POST请求请在HTTP Header中设置 Content-Type:application/json，否则接口调用失败
</aside>

<h4 id="获取accesstoken">获取AccessToken</h4>

<p>AccessToken是企业访问钉钉开放平台接口的全局唯一票据，调用接口时需携带AccessToken。</p>

<p>AccessToken需要用CorpID和CorpSecret来换取，不同的CorpSecret会返回不同的AccessToken。正常情况下AccessToken有效期为7200秒，有效期内重复获取返回相同结果，并自动续期。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET
<code class="prettyprint">https://oapi.dingtalk.com/gettoken?corpid=id&amp;corpsecret=secrect</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpid</td>
<td>String</td>
<td>是</td>
<td>企业Id</td>
</tr>
<tr>
<td>corpsecret</td>
<td>String</td>
<td>是</td>
<td>企业应用的凭证密钥</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>a)正确的Json返回结果:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fw8ef8we8f76e6f7s8df8s"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>错误码</td>
</tr>
<tr>
<td>errmsg</td>
<td>错误信息</td>
</tr>
<tr>
<td>access_token</td>
<td>获取到的凭证</td>
</tr>
</tbody></table>

<p>b)错误的Json返回示例:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">43003</span><span class="p">,</span><span class="w">
   </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"require https"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="管理通讯录">管理通讯录</h2>

<h3 id="获取部门列表">获取部门列表</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/list?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
           </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"来往事业部"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"服务端开发组"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>department</td>
<td>部门列表数据。以部门的order字段从小到大排列</td>
</tr>
<tr>
<td>id</td>
<td>部门id</td>
</tr>
<tr>
<td>name</td>
<td>部门名称</td>
</tr>
<tr>
<td>parentid</td>
<td>父部门id，根部门为1</td>
</tr>
</tbody></table>

<h3 id="创建部门">创建部门</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/create?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"来往事业部"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>部门名称。长度限制为1~64个字符</td>
</tr>
<tr>
<td>parentid</td>
<td>String</td>
<td>是</td>
<td>父部门id。根部门id为1</td>
</tr>
<tr>
<td>order</td>
<td>String</td>
<td>否</td>
<td>在父部门中的次序值。order值小的排序靠前</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>id</td>
<td>创建的部门id</td>
</tr>
</tbody></table>

<h3 id="更新部门">更新部门</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/update?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"来往事业部"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>string</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>否</td>
<td>部门名称。长度限制为1~64个字符</td>
</tr>
<tr>
<td>parentid</td>
<td>String</td>
<td>否</td>
<td>父部门id。根部门id为1</td>
</tr>
<tr>
<td>order</td>
<td>String</td>
<td>否</td>
<td>在父部门中的次序值。order值小的排序靠前</td>
</tr>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>部门ID</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"updated"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="删除部门">删除部门</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/delete?access_token=ACCESS_TOKEN&amp;id=ID</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>部门ID。（注：不能删除根部门；不能删除含有子部门、成员的部门）</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deleted"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="获取成员">获取成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/get?access_token=ACCESS_TOKEN&amp;userid=zhangsan</code></p>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工在企业内的UserID，企业用来唯一标识用户的字段。</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
    </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"工程师"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"avatar"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dingtalk.com/abc.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"attrs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"爱好"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"卡号"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"1234567234"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>userid</td>
<td>员工UserID。对应管理端的帐号</td>
</tr>
<tr>
<td>name</td>
<td>成员名称</td>
</tr>
<tr>
<td>department</td>
<td>成员所属部门id列表</td>
</tr>
<tr>
<td>position</td>
<td>职位信息</td>
</tr>
<tr>
<td>avatar</td>
<td>头像url</td>
</tr>
<tr>
<td>extattr</td>
<td>扩展属性</td>
</tr>
</tbody></table>

<h3 id="创建成员">创建成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/create?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
    </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"产品经理"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15913215421"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan@gzdev.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"attrs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"爱好"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"卡号"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"1234567234"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工UserID。对应管理端的帐号，企业内必须唯一。长度为1~64个字符</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>成员名称。长度为1~64个字符</td>
</tr>
<tr>
<td>department</td>
<td>List</td>
<td>否</td>
<td>数组类型，数组里面值为整型，成员所属部门id列表</td>
</tr>
<tr>
<td>position</td>
<td>String</td>
<td>否</td>
<td>职位信息。长度为0~64个字符</td>
</tr>
<tr>
<td>mobile</td>
<td>String</td>
<td>是</td>
<td>手机号码。企业内必须唯一</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>否</td>
<td>邮箱。长度为0~64个字符。企业内必须唯一</td>
</tr>
<tr>
<td>extattr</td>
<td>JSONObject</td>
<td>否</td>
<td>扩展属性</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="更新成员">更新成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/update?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
    </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"产品经理"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15913215421"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan@gzdev.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"attrs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"爱好"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"卡号"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"1234567234"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工UserID。对应管理端的帐号，企业内必须唯一。长度为1~64个字符</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>成员名称。长度为1~64个字符</td>
</tr>
<tr>
<td>department</td>
<td>List</td>
<td>否</td>
<td>成员所属部门id列表</td>
</tr>
<tr>
<td>position</td>
<td>String</td>
<td>否</td>
<td>职位信息。长度为0~64个字符</td>
</tr>
<tr>
<td>mobile</td>
<td>String</td>
<td>是</td>
<td>手机号码。企业内必须唯一</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>否</td>
<td>邮箱。长度为0~64个字符。企业内必须唯一</td>
</tr>
<tr>
<td>extattr</td>
<td>JSONObject</td>
<td>否</td>
<td>扩展属性</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"updated"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="删除成员">删除成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/delete?access_token=ACCESS_TOKEN&amp;userid=ID</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工UserID。对应管理端的帐号</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deleted"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="批量删除成员">批量删除成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/batchdelete?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构">请求包结构</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"useridlist"</span><span class="p">:[</span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="s2">"lisi"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>useridlist</td>
<td>List</td>
<td>是</td>
<td>员工UserID列表。对应管理端的帐号，列表长度在1到20之间</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deleted"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="获取部门成员">获取部门成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/simplelist?access_token=ACCESS_TOKEN&amp;department_id=1&amp;fetch_child=0</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>department_id</td>
<td>long</td>
<td>是</td>
<td>获取的部门id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="w">
            </span><span class="s2">"active"</span><span class="err">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="err">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>userlist</td>
<td>成员列表</td>
</tr>
<tr>
<td>userid</td>
<td>员工UserID,对应管理端的帐号</td>
</tr>
<tr>
<td>name</td>
<td>成员名称</td>
</tr>
<tr>
<td>active</td>
<td>表示该用户是否激活了钉钉</td>
</tr>
</tbody></table>

<h3 id="获取部门成员（详情）">获取部门成员（详情）</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/list?access_token=ACCESS_TOKEN&amp;department_id=1&amp;fetch_child=0</code></p>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>department_id</td>
<td>long</td>
<td>是</td>
<td>获取的部门id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userlist"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
            </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"工程师"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan@alibaba-inc.com"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"openId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HJHJYT*Y8887"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"avatar"</span><span class="p">:</span><span class="w">  </span><span class="s2">"./dingtalk/abc.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"attrs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"爱好"</span><span class="p">,</span><span class="w">
                        </span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"卡号"</span><span class="p">,</span><span class="w">
                        </span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"1234567234"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>userlist</td>
<td>成员列表</td>
</tr>
<tr>
<td>userid</td>
<td>员工UserID,对应管理端的帐号</td>
</tr>
<tr>
<td>name</td>
<td>成员名称</td>
</tr>
<tr>
<td>active</td>
<td>表示该用户是否激活了钉钉</td>
</tr>
<tr>
<td>department</td>
<td>成员所属部门id列表</td>
</tr>
<tr>
<td>position</td>
<td>职位信息</td>
</tr>
<tr>
<td>email</td>
<td>邮箱</td>
</tr>
<tr>
<td>openId</td>
<td>开放平台openId</td>
</tr>
<tr>
<td>avatar</td>
<td>头像url</td>
</tr>
<tr>
<td>extattr</td>
<td>扩展属性</td>
</tr>
</tbody></table>

<!--
"mobile": "15913215421",
mobile | 手机号码
-->

<!--## 发送普通会话消息

员工可以把消息发送到同企业的人或群。

调用接口时，使用Https协议、JSON数据包格式。

目前支持文本、图片、语音、普通文件、OA消息以及link等消息类型，每个消息都由消息头和消息体组成，普通会话的消息头由sender,cid组成。消息体请参见以下各种[消息类型](#消息类型及数据格式)。

###### 参数说明

参数 | 参数类型 | 必须 | 说明
---------- | ------- | ------- | ------
sender | String | 是 | 消息发送者员工ID
cid | String | 是 | 群消息或者个人聊天会话Id（通过JSAPI唤起联系人界面拿到会话ID）

普通会话消息样例：

![msg1](https://img.alicdn.com/tps/TB1FVMvIFXXXXcnXXXXXXXXXXXX.jpg)

### 发送普通会话消息接口说明

###### 请求说明

Https请求方式: POST

`https://oapi.dingtalk.com/message/send_to_conversation?access_token=ACCESS_TOKEN`

###### 参数说明

参数 | 参数类型 | 必须 | 说明
---------- | ------- | ------- | ------
access_token |String | 是 | 调用接口凭证

###### 返回说明

如果是群，返回跟发送者同一家企业的一组工号；如果是个人聊天，只返回发送者同一家企业的一个工号；不在同一家企业，发送失败

```
{
    "errcode": 0,
    "errmsg": "ok",
    "receiver": "UserID1|UserID2"
}
```
-->

<h2 id="发送企业会话消息">发送企业会话消息</h2>

<p>企业可以主动发消息给员工，消息量不受限制。</p>

<p>调用接口时，使用Https协议、JSON数据包格式。</p>

<p>目前支持text、image、voice、file、link、OA消息类型。每个消息都由消息头和消息体组成，企业会话的消息头由touser,toparty,agentid组成。消息体请参见以下各种<a href="#消息类型及数据格式">消息类型</a>。</p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>touser</td>
<td>String</td>
<td>否</td>
<td>员工ID列表（消息接收者，多个接收者用&rsquo; &#124; &lsquo;分隔）。特殊情况：指定为@all，则向该企业应用的全部成员发送</td>
</tr>
<tr>
<td>toparty</td>
<td>String</td>
<td>否</td>
<td>部门ID列表，多个接收者用&rsquo; &#124; &#39;分隔。当touser为@all时忽略本参数</td>
</tr>
<tr>
<td>agentid</td>
<td>String</td>
<td>是</td>
<td>企业应用id，这个值代表以哪个应用的名义发送消息，如果不填，则以当前获取accesstoken的应用作为发消息的应用</td>
</tr>
</tbody></table>

<p>企业会话消息样例：</p>

<p><img alt="msg2" src="https://img.alicdn.com/tps/TB1PAQwIFXXXXXOXXXXXXXXXXXX.jpg" /></p>

<h3 id="发送企业消息接口说明">发送企业消息接口说明</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/message/send?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>如果收件人、部门或标签不存在，发送仍然执行，但返回无效的部分。</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"invaliduser"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UserID1|UserID2"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"invalidparty"</span><span class="p">:</span><span class="s2">"PartyID1"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="消息类型及数据格式">消息类型及数据格式</h2>

<h3 id="text消息">text消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三的请假申请"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>否</td>
<td>消息类型，此时固定为：text</td>
</tr>
<tr>
<td>content</td>
<td>String</td>
<td>是</td>
<td>消息内容</td>
</tr>
</tbody></table>

<h3 id="image消息">image消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>否</td>
<td>消息类型，此时固定为：image</td>
</tr>
<tr>
<td>media_id</td>
<td>String</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取。建议宽600像素 x 400像素，宽高比3：2</td>
</tr>
</tbody></table>

<h3 id="voice消息">voice消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"voice"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"voice"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>否</td>
<td>消息类型，此时固定为：text</td>
</tr>
<tr>
<td>media_id</td>
<td>String</td>
<td>是</td>
<td>语音媒体文件id，可以调用上传媒体文件接口获取。2MB，播放长度不超过60s，AMR格式</td>
</tr>
</tbody></table>

<h3 id="file消息">file消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"file"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>否</td>
<td>消息类型，此时固定为：file</td>
</tr>
<tr>
<td>media_id</td>
<td>String</td>
<td>是</td>
<td>媒体文件id，可以调用上传媒体文件接口获取。10MB</td>
</tr>
</tbody></table>

<h3 id="link消息">link消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"messageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://s.dingtalk.com/market/dingtalk/error_code.php"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"picUrl"</span><span class="p">:</span><span class="s2">"@lALOACZwe2Rk"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：link</td>
</tr>
</tbody></table>

<h5 id="link消息体格式">link消息体格式</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>link.messageUrl</td>
<td>String</td>
<td>是</td>
<td>消息点击链接地址</td>
</tr>
<tr>
<td>link.picUrl</td>
<td>String</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取</td>
</tr>
<tr>
<td>link.title</td>
<td>String</td>
<td>是</td>
<td>消息标题</td>
</tr>
<tr>
<td>link.text</td>
<td>String</td>
<td>是</td>
<td>消息描述</td>
</tr>
</tbody></table>

<h3 id="oa消息">OA消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
     </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"oa"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"oa"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"message_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://dingtalk.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"head"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"bgcolor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FFBBBBBB"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"头部标题"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"正文标题"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"form"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"姓名:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"年龄:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"身高:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.8米"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"体重:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"130斤"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"学历:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"本科"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"爱好:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"打球、听音乐"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nt">"rich"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"num"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15.6"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"元"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@lADOADmaWMzazQKA"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"file_count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"李四 "</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>否</td>
<td>消息类型，此时固定为：oa</td>
</tr>
</tbody></table>

<h4 id="oa消息体内容">OA消息体内容</h4>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>oa.message_url</td>
<td>String</td>
<td>是</td>
<td>客户端点击消息时跳转到的H5地址</td>
</tr>
<tr>
<td>oa.head</td>
<td>String</td>
<td>是</td>
<td>消息头部内容</td>
</tr>
<tr>
<td>oa.head.bgcolor</td>
<td>String</td>
<td>是</td>
<td>消息头部的背景颜色。长度限制为8个英文字符，其中前2为表示透明度，后6位表示颜色值。不要添加0x</td>
</tr>
<tr>
<td>oa.head.text</td>
<td>String</td>
<td>是</td>
<td>消息的头部标题</td>
</tr>
<tr>
<td>oa.body</td>
<td>Array[JSON Object]</td>
<td>是</td>
<td>消息体</td>
</tr>
<tr>
<td>oa.body.title</td>
<td>String</td>
<td>否</td>
<td>消息体的标题</td>
</tr>
<tr>
<td>oa.body.form</td>
<td>Array[JSON Object]</td>
<td>否</td>
<td>消息体的表单，最多显示6个，超过会被隐藏</td>
</tr>
<tr>
<td>oa.body.form.key</td>
<td>String</td>
<td>否</td>
<td>消息体的关键字</td>
</tr>
<tr>
<td>oa.body.form.value</td>
<td>String</td>
<td>否</td>
<td>消息体的关键字对应的值</td>
</tr>
<tr>
<td>oa.body.rich</td>
<td>Array[JSON Object]</td>
<td>否</td>
<td>单行富文本信息</td>
</tr>
<tr>
<td>oa.body.rich.num</td>
<td>String</td>
<td>否</td>
<td>单行富文本信息的数目</td>
</tr>
<tr>
<td>oa.body.rich.unit</td>
<td>String</td>
<td>否</td>
<td>单行富文本信息的单位</td>
</tr>
<tr>
<td>oa.body.content</td>
<td>String</td>
<td>否</td>
<td>消息体的内容，最多显示3行</td>
</tr>
<tr>
<td>oa.body.image</td>
<td>String</td>
<td>否</td>
<td>消息体中的图片media_id</td>
</tr>
<tr>
<td>oa.body.file_count</td>
<td>String</td>
<td>否</td>
<td>自定义的附件数目。此数字仅供显示，钉钉不作验证</td>
</tr>
<tr>
<td>oa.body.author</td>
<td>String</td>
<td>否</td>
<td>自定义的作者名字</td>
</tr>
</tbody></table>

<h4 id="oa消息截图">OA消息截图</h4>

<p><img alt="oames" src="https://img.alicdn.com/tps/TB1gVcFIFXXXXcGXXXXXXXXXXXX.jpg" /></p>

<h2 id="管理多媒体文件">管理多媒体文件</h2>

<p>企业在使用接口时，对多媒体文件、多媒体消息的获取和调用等操作，是通过media_id来进行的。通过本接口，企业可以上传或下载多媒体文件。</p>

<h3 id="上传媒体文件">上传媒体文件</h3>

<p>用于上传图片、语音等媒体资源文件以及普通文件（如doc，ppt），接口返回媒体资源标识ID：media_id。请注意，media_id是可复用的，同一个media_id可用于消息的多次发送。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/media/upload?access_token=ACCESS_TOKEN&amp;type=TYPE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>是</td>
<td>媒体文件类型，分别有图片（image）、语音（voice）、普通文件(file)</td>
</tr>
<tr>
<td>media</td>
<td>String</td>
<td>是</td>
<td>form-data中媒体文件标识，有filename、filelength、content-type等信息</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@dsa8d87y7c8d8c"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>错误码</td>
</tr>
<tr>
<td>errmsg</td>
<td>错误信息</td>
</tr>
<tr>
<td>type</td>
<td>媒体文件类型，分别有图片（image）、语音（voice）、普通文件(file)</td>
</tr>
<tr>
<td>media_id</td>
<td>媒体文件上传后获取的唯一标识</td>
</tr>
<tr>
<td>created_at</td>
<td>媒体文件上传时间戳</td>
</tr>
</tbody></table>

<h6 id="上传的媒体文件限制">上传的媒体文件限制</h6>

<ul>
<li>图片（image）:1MB，支持JPG格式</li>
<li>语音（voice）：2MB，播放长度不超过60s，AMR格式</li>
<li>普通文件（file）：10MB</li>
</ul>

<h3 id="获取媒体文件">获取媒体文件</h3>

<p>通过media_id获取图片、语音等文件。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/media/get?access_token=ACCESS_TOKEN&amp;media_id=MEDIA_ID</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>media</td>
<td>String</td>
<td>是</td>
<td>form-data中媒体文件标识，有filename、filelength、content-type等信息</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>和普通的http下载相同，请根据http头做相应的处理。</p>
<pre class="highlight plaintext"><code>  HTTP/1.1 200: OK
  Connection: close
  Content-Type: image/jpeg
  Content-disposition: attachment; filename="MEDIA_ID.jpg"
  Date: Sun, 04 Jan 2015 12:00:00 GMT
  Cache-Control: no-cache, must-revalidate
  Content-Length: 1234567
  ...
</code></pre>

<p>a)正确时返回：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40004</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid media_id"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>b)错误时返回（这里省略了HTTP首部）：</p>

<h2 id="免登服务">免登服务</h2>

<p>通过免登服务，在企业微应用的H5中，可以获取当前使用钉钉的用户身份及相关信息。</p>

<p>通过此接口获取用户身份会有一定的时间开销。对于频繁获取用户身份的场景，建议采用如下方案：</p>

<ol>
<li>用户跳转到企业页面时，企业校验是否有代表用户身份的cookie，此cookie由企业生成</li>
<li>如果没有获取到cookie，调用下述服务，获取用户身份后，由企业生成代表用户身份的cookie</li>
<li>根据cookie获取用户身份，进入相应的页面</li>
</ol>

<h3 id="使用标准oauth2-0">使用标准OAUTH2.0</h3>

<p>使用标准OAUTH2.0 HTTP 302 跳转方式获取CODE</p>

<p>在钉钉用户访问企业的H5时，如果企业应用服务器未从cookie中发现用户信息，则需要构造一个连接，通过HTTP 302跳转方式，让钉钉用户访问钉钉开放平台授权网址，构造的地址如下:</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/connect/oauth2/authorize?appid=CORPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE</code></p>

<p>钉钉开放平台授权服务器在判断当前用户属于当前企业时，会再次通过HTTP 302跳转回企业应用的H5，并在H5的URL后面追加参数code=CODE&amp;state=STATE</p>

<aside class="notice">
有安全限制，REDIRECT_URI域名必须包含在企业所有的微应用域名内,微应用请到钉钉oa后台->选择微应用菜单->微应用中心，添加微应用
</aside>

<p>例如：企业拥有www.taobao.com和www.tianmao.com两个域名，如果跳转到www.abc.com则会提示无权限访问。</p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>appid</td>
<td>String</td>
<td>是</td>
<td>企业的CorpID</td>
</tr>
<tr>
<td>redirect_uri</td>
<td>String</td>
<td>是</td>
<td>授权后重定向的回调链接地址，请使用urlencode对链接进行处理</td>
</tr>
<tr>
<td>response_type</td>
<td>String</td>
<td>是</td>
<td>返回类型，此时固定为：code</td>
</tr>
<tr>
<td>scope</td>
<td>String</td>
<td>是</td>
<td>应用授权作用域，此时固定为：snsapi_base</td>
</tr>
<tr>
<td>state</td>
<td>String</td>
<td>是</td>
<td>重定向后会带上state参数，企业可以填写a-zA-Z0-9的参数值，长度不可超过128个字节</td>
</tr>
<tr>
<td>#ding_redirect</td>
<td></td>
<td>是</td>
<td>钉钉终端使用此参数判断是否需要带上身份信息</td>
</tr>
</tbody></table>

<p>举例如下，假如企业的H5地址是 <code class="prettyprint">http://www.abc.com/oa</code></p>

<p>企业的CorpID是ding12345678</p>

<p>企业自定义的state是abcd1234</p>

<p>当钉钉用户在访问微应用内的H5时，企业自有服务器发现cookie中无法读取到用户信息时，需要构造如下链接并进行HTTP 302跳转</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/connect/oauth2/authorize?appid=ding12345678&amp;redirect_uri=http%3a%2f%2fwww.abc.com%2foa&amp;response_type=code&amp;scope=snsapi_base&amp;state=abcd1234</code></p>

<p>假如点击链接的当前钉钉用户属于当前企业(ding12345678)，则会HTTP 302跳到如下url。如果当前钉钉用户不属于当前企业，页面提示无权访问。</p>

<p><code class="prettyprint">http://www.abc.com/oa?code=CODE&amp;state=abcd1234</code></p>

<h3 id="通过code换取用户身份">通过CODE换取用户身份</h3>

<p>企业应用的服务器在拿到CODE后，需要将CODE发送到钉钉开放平台接口，如果验证通过，则返回CODE对应的用户信息。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/getuserinfo?access_token=ACCESS_TOKEN&amp;code=CODE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>code</td>
<td>String</td>
<td>是</td>
<td>通过Oauth认证会给URL带上CODE</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>

<p>正确时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40029</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid code"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USERID"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deviceId"</span><span class="p">:</span><span class="s2">"DEVICEID"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>userId</td>
<td>员工在企业内的UserID</td>
</tr>
<tr>
<td>deviceId</td>
<td>手机设备号,由钉钉在安装时随机产生</td>
</tr>
</tbody></table>

<p>出错时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40029</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid code"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="js接口api">JS接口API</h2>

<h3 id="获取jsapi_ticket">获取jsapi_ticket</h3>

<p>企业在使用微应用中的JS API时，需要先从钉钉开放平台接口获取jsapi_ticket生成签名数据，并将最终签名用的部分字段及签名结果返回到H5中，JS API底层将通过这些数据判断H5是否有权限使用JS API。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式：GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/get_jsapi_ticket?access_token=ACCESS_TOKE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>是</td>
<td>这里是固定值，jsapi</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>

<p>正确时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ticket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dsf8sdf87sd7f87sd8v8ds0vs09dvu09sd8vy87dsv87"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">7200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>错误码</td>
</tr>
<tr>
<td>errmsg</td>
<td>错误信息</td>
</tr>
<tr>
<td>ticket</td>
<td>用于JS API的临时票据</td>
</tr>
<tr>
<td>expires_in</td>
<td>票据过期时间</td>
</tr>
</tbody></table>

<p>出错时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">45009</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"接口调用超过限制"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="js-sdk">JS-SDK</h3>

<p>JS-SDK 为H5页面提供了一系列调用原生用的UI控件或者服务的JS接口，文档地址如下：</p>

<p><a href="http://open.dingtalk.com/#客户端开发文档">http://open.dingtalk.com/#客户端开发文档</a></p>

<h2 id="附录">附录</h2>

<h3 id="全局返回码说明">全局返回码说明</h3>

<p>开发者每次调用接口时，可能获得正确或错误的返回码，企业可以根据返回码信息调试接口，排查错误。</p>

<h6 id="全局返回码说明如下：">全局返回码说明如下：</h6>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>-1</td>
<td>系统繁忙</td>
</tr>
<tr>
<td>0</td>
<td>请求成功</td>
</tr>
<tr>
<td>40001</td>
<td>获取access_token时Secret错误，或者access_token无效</td>
</tr>
<tr>
<td>40002</td>
<td>不合法的凭证类型</td>
</tr>
<tr>
<td>40003</td>
<td>不合法的UserID</td>
</tr>
<tr>
<td>40004</td>
<td>不合法的媒体文件类型</td>
</tr>
<tr>
<td>40005</td>
<td>不合法的文件类型</td>
</tr>
<tr>
<td>40006</td>
<td>不合法的文件大小</td>
</tr>
<tr>
<td>40007</td>
<td>不合法的媒体文件id</td>
</tr>
<tr>
<td>40008</td>
<td>不合法的消息类型</td>
</tr>
<tr>
<td>40009</td>
<td>不合法的部门id</td>
</tr>
<tr>
<td>40010</td>
<td>不合法的父部门id</td>
</tr>
<tr>
<td>40011</td>
<td>不合法的排序order</td>
</tr>
<tr>
<td>40012</td>
<td>不合法的发送者</td>
</tr>
<tr>
<td>40013</td>
<td>不合法的corpid</td>
</tr>
<tr>
<td>40014</td>
<td>不合法的access_token</td>
</tr>
<tr>
<td>40015</td>
<td>发送者不在会话中</td>
</tr>
<tr>
<td>40016</td>
<td>不合法的会话ID</td>
</tr>
<tr>
<td>40017</td>
<td>在会话中没有找到与发送者在同一企业的人</td>
</tr>
<tr>
<td>40029</td>
<td>不合法的oauth_code</td>
</tr>
<tr>
<td>40031</td>
<td>不合法的UserID列表</td>
</tr>
<tr>
<td>40032</td>
<td>不合法的UserID列表长度</td>
</tr>
<tr>
<td>40033</td>
<td>不合法的请求字符，不能包含uxxxx格式的字符</td>
</tr>
<tr>
<td>40035</td>
<td>不合法的参数</td>
</tr>
<tr>
<td>40038</td>
<td>不合法的请求格式</td>
</tr>
<tr>
<td>40039</td>
<td>不合法的URL长度</td>
</tr>
<tr>
<td>40048</td>
<td>url中包含不合法domain</td>
</tr>
<tr>
<td>40055</td>
<td>不合法的agent结构</td>
</tr>
<tr>
<td>40056</td>
<td>不合法的agentid</td>
</tr>
<tr>
<td>40057</td>
<td>不合法的callbackurl</td>
</tr>
<tr>
<td>40061</td>
<td>设置应用头像失败</td>
</tr>
<tr>
<td>40062</td>
<td>不合法的应用模式</td>
</tr>
<tr>
<td>40064</td>
<td>管理组名字已存在</td>
</tr>
<tr>
<td>40065</td>
<td>不合法的管理组名字长度</td>
</tr>
<tr>
<td>40066</td>
<td>不合法的部门列表</td>
</tr>
<tr>
<td>40067</td>
<td>标题长度不合法</td>
</tr>
<tr>
<td>40073</td>
<td>不合法的openid</td>
</tr>
<tr>
<td>40077</td>
<td>不合法的预授权码</td>
</tr>
<tr>
<td>40078</td>
<td>不合法的临时授权码</td>
</tr>
<tr>
<td>40079</td>
<td>不合法的授权信息</td>
</tr>
<tr>
<td>40080</td>
<td>不合法的suitesecret</td>
</tr>
<tr>
<td>40082</td>
<td>不合法的suitetoken</td>
</tr>
<tr>
<td>40083</td>
<td>不合法的suiteid</td>
</tr>
<tr>
<td>40084</td>
<td>不合法的永久授权码</td>
</tr>
<tr>
<td>40085</td>
<td>不合法的suiteticket</td>
</tr>
<tr>
<td>40086</td>
<td>不合法的第三方应用appid</td>
</tr>
<tr>
<td>40086</td>
<td>不合法的第三方应用appid</td>
</tr>
<tr>
<td>40087</td>
<td>创建永久授权码失败</td>
</tr>
<tr>
<td>40088</td>
<td>不合法的套件key或secret</td>
</tr>
<tr>
<td>41001</td>
<td>缺少access_token参数</td>
</tr>
<tr>
<td>41002</td>
<td>缺少corpid参数</td>
</tr>
<tr>
<td>41003</td>
<td>缺少refresh_token参数</td>
</tr>
<tr>
<td>41004</td>
<td>缺少secret参数</td>
</tr>
<tr>
<td>41005</td>
<td>缺少多媒体文件数据</td>
</tr>
<tr>
<td>41006</td>
<td>缺少media_id参数</td>
</tr>
<tr>
<td>41008</td>
<td>缺少oauth</td>
</tr>
<tr>
<td>41009</td>
<td>缺少UserID</td>
</tr>
<tr>
<td>41010</td>
<td>缺少url</td>
</tr>
<tr>
<td>41011</td>
<td>缺少agentid</td>
</tr>
<tr>
<td>41012</td>
<td>缺少应用头像mediaid</td>
</tr>
<tr>
<td>41013</td>
<td>缺少应用名字</td>
</tr>
<tr>
<td>41014</td>
<td>缺少应用描述</td>
</tr>
<tr>
<td>41015</td>
<td>缺少Content</td>
</tr>
<tr>
<td>41016</td>
<td>缺少标题</td>
</tr>
<tr>
<td>41021</td>
<td>缺少suiteid</td>
</tr>
<tr>
<td>41022</td>
<td>缺少suitetoken</td>
</tr>
<tr>
<td>41023</td>
<td>缺少suiteticket</td>
</tr>
<tr>
<td>41024</td>
<td>缺少suitesecret</td>
</tr>
<tr>
<td>41025</td>
<td>缺少永久授权码</td>
</tr>
<tr>
<td>41026</td>
<td>需要tmp_auth_code</td>
</tr>
<tr>
<td>41027</td>
<td>需要授权企业的corpid参数</td>
</tr>
<tr>
<td>41030</td>
<td>企业未对该套件授权</td>
</tr>
<tr>
<td>41031</td>
<td>auth_corpid和permanent_code不匹配</td>
</tr>
<tr>
<td>42001</td>
<td>access_token超时</td>
</tr>
<tr>
<td>42002</td>
<td>refresh_token超时</td>
</tr>
<tr>
<td>42003</td>
<td>oauth_code超时</td>
</tr>
<tr>
<td>42007</td>
<td>预授权码失效</td>
</tr>
<tr>
<td>42008</td>
<td>临时授权码失效</td>
</tr>
<tr>
<td>42009</td>
<td>suitetoken失效</td>
</tr>
<tr>
<td>43001</td>
<td>需要GET请求</td>
</tr>
<tr>
<td>43002</td>
<td>需要POST请求</td>
</tr>
<tr>
<td>43003</td>
<td>需要HTTPS</td>
</tr>
<tr>
<td>43004</td>
<td>无效的HTTP HEADER Content-Type</td>
</tr>
<tr>
<td>43005</td>
<td>需要Content-Type为application/json;charset=UTF-8</td>
</tr>
<tr>
<td>43007</td>
<td>需要授权</td>
</tr>
<tr>
<td>43010</td>
<td>需要处于回调模式</td>
</tr>
<tr>
<td>43011</td>
<td>需要企业授权</td>
</tr>
<tr>
<td>44001</td>
<td>多媒体文件为空</td>
</tr>
<tr>
<td>44002</td>
<td>POST的数据包为空</td>
</tr>
<tr>
<td>44003</td>
<td>图文消息内容为空</td>
</tr>
<tr>
<td>44004</td>
<td>文本消息内容为空</td>
</tr>
<tr>
<td>45001</td>
<td>多媒体文件大小超过限制</td>
</tr>
<tr>
<td>45002</td>
<td>消息内容超过限制</td>
</tr>
<tr>
<td>45003</td>
<td>标题字段超过限制</td>
</tr>
<tr>
<td>45004</td>
<td>描述字段超过限制</td>
</tr>
<tr>
<td>45005</td>
<td>链接字段超过限制</td>
</tr>
<tr>
<td>45006</td>
<td>图片链接字段超过限制</td>
</tr>
<tr>
<td>45007</td>
<td>语音播放时间超过限制</td>
</tr>
<tr>
<td>45008</td>
<td>图文消息超过限制</td>
</tr>
<tr>
<td>45009</td>
<td>接口调用超过限制</td>
</tr>
<tr>
<td>45016</td>
<td>系统分组，不允许修改</td>
</tr>
<tr>
<td>45017</td>
<td>分组名字过长</td>
</tr>
<tr>
<td>45018</td>
<td>分组数量超过上限</td>
</tr>
<tr>
<td>45024</td>
<td>账号数量超过上限</td>
</tr>
<tr>
<td>46001</td>
<td>不存在媒体数据</td>
</tr>
<tr>
<td>46004</td>
<td>不存在的员工</td>
</tr>
<tr>
<td>47001</td>
<td>解析JSON/XML内容错误</td>
</tr>
<tr>
<td>48002</td>
<td>API禁用</td>
</tr>
<tr>
<td>48003</td>
<td>suitetoken无效</td>
</tr>
<tr>
<td>48004</td>
<td>授权关系无效</td>
</tr>
<tr>
<td>50001</td>
<td>redirect_uri未授权</td>
</tr>
<tr>
<td>50002</td>
<td>员工不在权限范围</td>
</tr>
<tr>
<td>50003</td>
<td>应用已停用</td>
</tr>
<tr>
<td>50005</td>
<td>企业已禁用</td>
</tr>
<tr>
<td>60001</td>
<td>部门长度不符合限制</td>
</tr>
<tr>
<td>60002</td>
<td>部门层级深度超过限制</td>
</tr>
<tr>
<td>60003</td>
<td>部门不存在</td>
</tr>
<tr>
<td>60004</td>
<td>父亲部门不存在</td>
</tr>
<tr>
<td>60005</td>
<td>不允许删除有成员的部门</td>
</tr>
<tr>
<td>60006</td>
<td>不允许删除有子部门的部门</td>
</tr>
<tr>
<td>60007</td>
<td>不允许删除根部门</td>
</tr>
<tr>
<td>60008</td>
<td>部门名称已存在</td>
</tr>
<tr>
<td>60009</td>
<td>部门名称含有非法字符</td>
</tr>
<tr>
<td>60010</td>
<td>部门存在循环关系</td>
</tr>
<tr>
<td>60011</td>
<td>管理员权限不足，（user/department/agent）无权限</td>
</tr>
<tr>
<td>60012</td>
<td>不允许删除默认应用</td>
</tr>
<tr>
<td>60013</td>
<td>不允许关闭应用</td>
</tr>
<tr>
<td>60014</td>
<td>不允许开启应用</td>
</tr>
<tr>
<td>60015</td>
<td>不允许修改默认应用可见范围</td>
</tr>
<tr>
<td>60017</td>
<td>不允许设置企业</td>
</tr>
<tr>
<td>60018</td>
<td>不允许更新根部门</td>
</tr>
<tr>
<td>60020</td>
<td>访问ip不在白名单之中</td>
</tr>
<tr>
<td>60102</td>
<td>UserID已存在</td>
</tr>
<tr>
<td>60103</td>
<td>手机号码不合法</td>
</tr>
<tr>
<td>60104</td>
<td>手机号码已存在</td>
</tr>
<tr>
<td>60105</td>
<td>邮箱不合法</td>
</tr>
<tr>
<td>60106</td>
<td>邮箱已存在</td>
</tr>
<tr>
<td>60110</td>
<td>部门个数超出限制</td>
</tr>
<tr>
<td>60111</td>
<td>UserID不存在</td>
</tr>
<tr>
<td>60112</td>
<td>成员姓名不合法</td>
</tr>
<tr>
<td>60113</td>
<td>身份认证信息（手机/邮箱）不能同时为空</td>
</tr>
<tr>
<td>60114</td>
<td>性别不合法</td>
</tr>
<tr>
<td>60118</td>
<td>用户无有效邀请字段（邮箱，手机号）</td>
</tr>
<tr>
<td>60119</td>
<td>不合法的position</td>
</tr>
<tr>
<td>60120</td>
<td>用户已禁用</td>
</tr>
<tr>
<td>60121</td>
<td>找不到该用户</td>
</tr>
<tr>
<td>60122</td>
<td>不合法的extattr</td>
</tr>
<tr>
<td>70001</td>
<td>企业不存在或者已经被解散</td>
</tr>
<tr>
<td>70002</td>
<td>获取套件下的微应用失败</td>
</tr>
<tr>
<td>70003</td>
<td>agentid对应微应用不存在</td>
</tr>
<tr>
<td>70004</td>
<td>企业下没有对应该agentid的微应用</td>
</tr>
<tr>
<td>70005</td>
<td>ISV激活套件失败</td>
</tr>
<tr>
<td>80001</td>
<td>可信域名没有IPC备案，后续将不能在该域名下正常使用jssdk</td>
</tr>
<tr>
<td>900001</td>
<td>加密明文文本非法</td>
</tr>
<tr>
<td>900002</td>
<td>加密时间戳参数非法</td>
</tr>
<tr>
<td>900003</td>
<td>加密随机字符串参数非法</td>
</tr>
<tr>
<td>900004</td>
<td>不合法的aeskey</td>
</tr>
<tr>
<td>900005</td>
<td>签名不匹配</td>
</tr>
<tr>
<td>900006</td>
<td>计算签名错误</td>
</tr>
<tr>
<td>900007</td>
<td>计算加密文字错误</td>
</tr>
<tr>
<td>900008</td>
<td>计算解密文字错误</td>
</tr>
<tr>
<td>900009</td>
<td>计算解密文字长度不匹配</td>
</tr>
<tr>
<td>900010</td>
<td>计算解密文字corpid不匹配</td>
</tr>
</tbody></table>

<h2 id="demo">Demo</h2>

<p>提供了使用Java、PHP、Nodejs 接入钉钉开放平台API的代码示例</p>

<p>下面的代码示例展示了一些常用API的使用方式，在运行下面的示例前请先获取CorpID和CorpSecret，并按照示例下的说明配置到合适的位置。</p>

<h3 id="java版本">Java版本</h3>
<pre class="highlight javascript"><code> <span class="kr">public</span> <span class="kr">class</span> <span class="nx">Env</span> <span class="p">{</span>
  <span class="kr">public</span> <span class="kr">static</span> <span class="kr">final</span> <span class="nb">String</span> <span class="nx">OAPI_HOST</span> <span class="o">=</span> <span class="s2">"https://oapi.dingtalk.com"</span><span class="p">;</span>
    <span class="kr">public</span> <span class="kr">static</span> <span class="kr">final</span> <span class="nb">String</span> <span class="nx">CORP_ID</span> <span class="o">=</span> <span class="s2">"corpid"</span><span class="p">;</span>
    <span class="kr">public</span> <span class="kr">static</span> <span class="kr">final</span> <span class="nb">String</span> <span class="nx">SECRET</span> <span class="o">=</span> <span class="s2">"secret"</span><span class="p">;</span>
 <span class="p">}</span>

</code></pre>

<p>1.将您的CorpID和CorpSecret配置在Env.java文件</p>

<p>2.启动您的服务器，如果配置正确，则会成功启动。</p>

<p><a href="https://github.com/injekt/openapi-demo-java">Demo地址：</a>
<code class="prettyprint">https://github.com/injekt/openapi-demo-java</code></p>

<h3 id="php版本">PHP版本</h3>
<pre class="highlight javascript"><code> <span class="nx">define</span><span class="p">(</span><span class="s2">"OAPI_HOST"</span><span class="p">,</span> <span class="s2">"https://oapi.dingtalk.com"</span><span class="p">);</span>
 <span class="nx">define</span><span class="p">(</span><span class="s2">"CORPID"</span><span class="p">,</span> <span class="s2">""</span><span class="p">);</span>
 <span class="nx">define</span><span class="p">(</span><span class="s2">"SECRET"</span><span class="p">,</span> <span class="s2">""</span><span class="p">);</span>
</code></pre>

<p>1.将您的CorpID和CorpSecret配置在env.php文件</p>

<p>2.启动您的服务器，如果配置正确，则会成功启动。</p>

<p><a href="https://github.com/injekt/openapi-demo-php">Demo地址：</a>
<code class="prettyprint">https://github.com/injekt/openapi-demo-php</code></p>

<h3 id="node-js版本">Node.js版本</h3>
<pre class="highlight javascript"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">secret</span><span class="p">:</span> <span class="s1">''</span>
<span class="p">};</span>
</code></pre>

<p>1.将您的CorpID和CorpSecret配置在env.js文件</p>

<p>2.启动您的服务器，如果配置正确，则会成功启动。</p>

<p><a href="https://github.com/injekt/openapi-demo-nodejs">Demo地址：</a>
<code class="prettyprint">https://github.com/injekt/openapi-demo-nodejs</code></p>

          <h1 id="客户端开发文档">客户端开发文档</h1>

<h2 id="通用">通用</h2>

<h3 id="页面引入js文件">页面引入js文件</h3>

<p><code class="prettyprint">http://g.alicdn.com/ilw/ding/0.3.8/scripts/dingtalk.js</code></p>

<p>或者</p>

<p><code class="prettyprint">https://g.alicdn.com/ilw/ding/0.3.8/scripts/dingtalk.js</code></p>

<h3 id="全局变量、命名空间">全局变量、命名空间</h3>

<p>直接引入dingtalk.js会得到一个全局变量<code class="prettyprint">dd</code>，支持amd、cmd引入方式</p>

<p>全局变量dd，命名空间：设备(dd.device)、业务(dd.biz)</p>

<h3 id="权限验证配置">权限验证配置</h3>

<p>钉钉JS API安全验证，只有经过安全验证的微应用才能调用安全级别较高的API。该功能在钉钉客户端iOS版2.2.2和安卓版2.2.0开始支持。</p>

<p>获取JS-API权限验证使用的签名的方法请参考附录-<a href="#js-api权限签名算法">JS-API权限签名算法</a></p>
<pre class="highlight javascript"><code> <span class="nx">dd</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，微应用ID</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span><span class="c1">//必填，企业ID</span>
    <span class="na">timestamp</span><span class="p">:</span> <span class="p">,</span> <span class="c1">// 必填，生成签名的时间戳</span>
    <span class="na">nonceStr</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，生成签名的随机串</span>
    <span class="na">signature</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，签名</span>
    <span class="na">jsApiList</span><span class="p">:</span> <span class="p">[</span><span class="s1">'device.notification.alert'</span><span class="p">,</span> <span class="s1">'device.notification.confirm'</span><span class="p">]</span> <span class="c1">// 必填，需要使用的jsapi列表</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>appId</td>
<td>String</td>
<td>是</td>
<td>微应用ID</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>是</td>
<td>企业ID</td>
</tr>
<tr>
<td>timestamp</td>
<td>String</td>
<td>是</td>
<td>生成签名的时间戳</td>
</tr>
<tr>
<td>nonceStr</td>
<td>String</td>
<td>是</td>
<td>生成签名的随机串</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>是</td>
<td>签名</td>
</tr>
<tr>
<td>jsApiList</td>
<td>Array</td>
<td>是</td>
<td>需要调用的jsapi列表</td>
</tr>
</tbody></table>

<h3 id="通过ready接口处理成功验证">通过ready接口处理成功验证</h3>

<p>须把相关接口放在ready函数中调用来确保正确执行。</p>

<p>config信息验证后会执行ready方法，所有接口调用都必须在config接口获得结果之后，config是一个客户端的异步操作，所以如果需要在页面加载时就调用相关接口，则须把相关接口放在ready函数中调用来确保正确执行。对于用户触发时才调用的接口，则可以直接调用，不需要放在ready函数中。</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="p">;</span>
<span class="p">});</span>
</code></pre>

<h3 id="通过error接口处理失败验证">通过error接口处理失败验证</h3>

<p>config信息验证失败会执行error函数，错误信息可以在返回的error参数中参看</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
    <span class="p">;</span>
<span class="p">});</span>
</code></pre>

<h3 id="接口约定">接口约定</h3>

<ul>
<li>所有接口都为异步</li>
<li>接受一个object类型的参数</li>
<li>成功回调 onSuccess</li>
<li>失败回调 onFail</li>
</ul>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="err">命名空间</span><span class="p">.</span><span class="err">功能</span><span class="p">.</span><span class="err">方法</span><span class="p">({</span>
    <span class="err">参数</span><span class="mi">1</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="err">参数</span><span class="mi">2</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//成功回调</span>
    <span class="cm">/*
    {
        //所有返回信息都输出在这里
    }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="c1">//失败回调</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h2 id="容器">容器</h2>

<p>dd.runtime</p>

<h3 id="获取容器信息">获取容器信息</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">info</span><span class="p">({</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/*{
        ability: '0.0.2' //容器版本，用来标识JSAPI能力，可根据该版本来决定能否使用jsapi
    }*/</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>ability</td>
<td>容器版本，用来标识JSAPI能力，可根据该版本来决定能否使用jsapi</td>
</tr>
</tbody></table>

<h3 id="授权">授权</h3>

<h3 id="请求授权码">请求授权码</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">permission</span><span class="p">.</span><span class="nx">requestAuthCode</span><span class="p">({</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/*{
        code: 'hYLK98jkf0m' //string authCode
    }*/</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>授权码</td>
</tr>
</tbody></table>

<!--### 请求jsapi

0.0.5

```javascript
dd.runtime.permission.requestJsApis({
    corpId: '', //企业ID
    timeStamp: '', //生成签名的时间戳
    nonceStr: '', //生成签名的随机串
    signature: '', //签名
    jsApiList: [], //需要调用的jsapi列表
    onSuccess: function(result) {
    /*{
        jsApilist: [] //array[string] authJsApiList
    }*/
    }
})
```
##### 参数说明

参数 | 参数类型 | 必须 | 说明
----- | ------- | ------- | ------
corpId | String | 是 | 企业ID
timeStamp | String | 是 | 生成签名的时间戳
nonceStr | String | 是 | 生成签名的随机串
signature | String | 是 | 签名
jsApiList | array[string] | 是 | 需要调用的jsapi列表

##### 返回说明

参数 | 说明
---- | -----
jsApilist | 授权的JsApi列表
-->

<h2 id="设备">设备</h2>

<p>dd.device</p>

<h3 id="基础信息">基础信息</h3>

<h3 id="获取设备唯一识别码">获取设备唯一识别码</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">base</span><span class="p">.</span><span class="nx">getUUID</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            uuid: '3udbhg98ddlljokkkl' //
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>uuid</td>
<td>设备唯一识别码</td>
</tr>
</tbody></table>

<h3 id="获取热点接入信息">获取热点接入信息</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">base</span><span class="p">.</span><span class="nx">getInterface</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            ssid: 'alibaba-inc',
            macIp: '3c:12:aa:09'
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>ssid</td>
<td>热点ssid</td>
</tr>
<tr>
<td>macIp</td>
<td>热点mac地址</td>
</tr>
</tbody></table>

<h2 id="启动器">启动器</h2>

<p>dd.device</p>

<h3 id="检测应用是否安装">检测应用是否安装</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">launcher</span><span class="p">.</span><span class="nx">checkInstalledApps</span><span class="p">({</span>
    <span class="na">apps</span><span class="p">:</span> <span class="p">[</span><span class="s1">'taobao'</span><span class="p">,</span> <span class="s1">'tmall'</span><span class="p">],</span> <span class="c1">//应用scheme</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            installed: ['taobao', 'tmall'] //应用scheme
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>apps</td>
<td>Array[String]</td>
<td>应用scheme</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>installed</td>
<td>应用scheme应用scheme</td>
</tr>
</tbody></table>

<h3 id="启动第三方应用">启动第三方应用</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">launcher</span><span class="p">.</span><span class="nx">launchApp</span><span class="p">({</span>
    <span class="na">app</span><span class="p">:</span> <span class="s1">'taobao'</span><span class="p">,</span> <span class="c1">//应用scheme</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            result: true //true 唤起成功 false 唤起失败
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>app</td>
<td>String</td>
<td>应用scheme</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>result</td>
<td>值为true说明唤起成功，值为false说明唤起失败</td>
</tr>
</tbody></table>

<h3 id="获取当前网络类型">获取当前网络类型</h3>

<p>0.0.2</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">getNetworkType</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            result: 'wifi' // result值: wifi 2g 3g 4g unknown none   none表示离线
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>result</td>
<td>result值: wifi、2g、3g、4g、unknown、none，none表示离线</td>
</tr>
</tbody></table>

<h3 id="事件">事件</h3>

<p>支持事件： pause、resume、online、offline、backbutton(android)
0.0.2 全部支持</p>

<p>swipeRefresh 0.0.5</p>
<pre class="highlight plaintext"><code>//退到后台(webview)
document.addEventListener('pause', function(e) {
    e.preventDefault();
    console.log('事件：pause')
}, false);

//唤醒(webview)
document.addEventListener('resume', function(e) {
    e.preventDefault();
    console.log('事件：resume')
}, false);

//在线
document.addEventListener('online', function(e) {
    e.preventDefault();
    console.log('事件：online')
}, false);

//离线
document.addEventListener('offline', function(e) {
    e.preventDefault();
    console.log('事件：offline')
}, false);

//返回按钮(android)
document.addEventListener('backbutton', function(e) {
    e.preventDefault();
    dd.device.notification.alert({
        message: '哎呀，你不小心点到返回键啦!',
        title: '...警告...'
    });
}, false);

//webview下拉刷新
document.addEventListener('swipeRefresh', function(e) {
    e.preventDefault();
    console.log('事件：swipeRefresh')
}, false);
</code></pre>

<h2 id="弹窗">弹窗</h2>

<p>dd.device</p>

<h3 id="alert">alert</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">alert</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//可传空</span>
    <span class="na">buttonName</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="cm">/*回调*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息内容</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>弹窗标题</td>
</tr>
<tr>
<td>buttonName</td>
<td>String</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h3 id="confirm">confirm</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">confirm</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">buttonLabels</span><span class="p">:</span> <span class="p">[</span><span class="s1">'确认'</span><span class="p">,</span> <span class="s1">'取消'</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            buttonIndex: 0 //被点击按钮的索引值，Number类型，从0开始
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息说明</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>buttonLabels</td>
<td>Array[String]</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number类型，从0开始</td>
</tr>
</tbody></table>

<h3 id="prompt">prompt</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">prompt</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">buttonLabels</span><span class="p">:</span> <span class="p">[</span><span class="s1">'确认'</span><span class="p">,</span> <span class="s1">'取消'</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            buttonIndex: 0, //被点击按钮的索引值，Number类型，从0开始
            value: '' //输入的值
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息内容</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>buttonLabels</td>
<td>Array[String]</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number类型，从0开始</td>
</tr>
<tr>
<td>value</td>
<td>输入的值</td>
</tr>
</tbody></table>

<h3 id="vibrate">vibrate</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">vibrate</span><span class="p">({</span>
    <span class="na">duration</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="c1">//震动时间，android可配置 iOS忽略</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>duration</td>
<td>Number</td>
<td>震动时间，android可配置 iOS忽略</td>
</tr>
</tbody></table>

<h3 id="showpreloader">showPreloader</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">showPreloader</span><span class="p">({</span>
    <span class="na">text</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="c1">//loading显示的字符，空表示不显示文字</span>
    <span class="na">showIcon</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span> <span class="c1">//是否显示icon，默认true</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{}*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>String</td>
<td>loading显示的字符，空表示不显示文字</td>
</tr>
<tr>
<td>showIcon</td>
<td>Boolean</td>
<td>是否显示icon，默认true</td>
</tr>
</tbody></table>

<h3 id="hidepreloader">hidePreloader</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">hidePreloader</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{}*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h3 id="toast">toast</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">toast</span><span class="p">({</span>
    <span class="na">icon</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//icon样式，有success和error，默认为空 0.0.2</span>
    <span class="na">text</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="c1">//提示信息</span>
    <span class="na">duration</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//显示持续时间，单位秒，默认按系统规范[android只有两种(&lt;=2s &gt;2s)]</span>
    <span class="na">delay</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//延迟显示，单位秒，默认0</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{}*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>icon</td>
<td>Boolean</td>
<td>icon样式，有success和error，默认为空 0.0.2</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>提示信息</td>
</tr>
<tr>
<td>duration</td>
<td>Number</td>
<td>显示持续时间，单位秒，默认按系统规范[android只有两种(&lt;=2s &gt;2s)]</td>
</tr>
<tr>
<td>delay</td>
<td>Number</td>
<td>延迟显示，单位秒，默认0</td>
</tr>
</tbody></table>

<h3 id="actionsheet">actionsheet</h3>

<p>0.0.2</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">actionSheet</span><span class="p">({</span>
    <span class="na">title</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//标题</span>
    <span class="na">cancelButton</span><span class="p">:</span> <span class="s1">'取消'</span><span class="p">,</span> <span class="c1">//取消按钮文本</span>
    <span class="na">otherButtons</span><span class="p">:</span> <span class="p">[</span><span class="s1">'按钮1'</span><span class="p">,</span> <span class="s1">'按钮2'</span><span class="p">,</span> <span class="s1">'按钮3'</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            buttonIndex: 0 //被点击按钮的索引值，Number，从0开始, 取消按钮为-1
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>cancelButton</td>
<td>String</td>
<td>取消按钮文本</td>
</tr>
<tr>
<td>otherButtons</td>
<td>Array[String]</td>
<td>其他按钮列表</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number，从0开始, 取消按钮为-1</td>
</tr>
</tbody></table>

<h2 id="地图">地图</h2>

<p>dd.device</p>

<h3 id="获取当前地址位置">获取当前地址位置</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            longitude : Number,
            latitude : Number,
            accuracy : Number,
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>longitude</td>
<td>经度</td>
</tr>
<tr>
<td>latitude</td>
<td>纬度</td>
</tr>
<tr>
<td>accuracy</td>
<td>准确度</td>
</tr>
</tbody></table>

<h3 id="搜索">搜索</h3>

<p>0.0.6</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">search</span><span class="p">({</span>
  <span class="na">scope</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//定位范围</span>
  <span class="na">extraInfo</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">prompt</span><span class="p">:</span> <span class="s2">"提示信息"</span>
  <span class="p">}</span>
  <span class="nl">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="cm">/* data结构
      {
      "province": ""//省
      "provinceCode": "" //省份编码
      "city": "" //城市
      "cityCode": "" //城市编码
      "adCode": "" // POI的行政区划代码
      "adName": "" // POI的行政区划名称
      "distance": "" //获取POI距离中心点的距离
      "postCode": "" //返回POI的邮编
      "title": "" //POI的名称
      "snippet": "" //POI的地址
      "longitude": 11.11, //该点经度
      "latitude": 11.11, //该点纬度
      }
  */</span>
  <span class="p">},</span>
  <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>scope</td>
<td>Number</td>
<td>定位范围</td>
</tr>
<tr>
<td>extraInfo.prompt</td>
<td>String</td>
<td>提示信息</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>province</td>
<td>省份</td>
</tr>
<tr>
<td>provinceCode</td>
<td>省份编码</td>
</tr>
<tr>
<td>city</td>
<td>城市</td>
</tr>
<tr>
<td>cityCode</td>
<td>城市编码</td>
</tr>
<tr>
<td>adCode</td>
<td>POI的行政区划代码</td>
</tr>
<tr>
<td>adName</td>
<td>POI的行政区划名称</td>
</tr>
<tr>
<td>distance</td>
<td>获取POI距离中心点的距离</td>
</tr>
<tr>
<td>postCode</td>
<td>返回POI的邮编</td>
</tr>
<tr>
<td>title</td>
<td>POI的名称</td>
</tr>
<tr>
<td>snippet</td>
<td>POI的地址</td>
</tr>
<tr>
<td>longitude</td>
<td>该点经度</td>
</tr>
<tr>
<td>latitude</td>
<td>该点纬度</td>
</tr>
</tbody></table>

<h3 id="定位">定位</h3>

<p>0.0.6</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">locate</span><span class="p">({</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
   <span class="cm">/* data结构
      {
      "province": ""//省
      "provinceCode": "" //省份编码
      "city": "" //城市
      "cityCode": "" //城市编码
      "adCode": "" // POI的行政区划代码
      "adName": "" // POI的行政区划名称
      "distance": "" //获取POI距离中心点的距离
      "postCode": "" //返回POI的邮编
      "title": "" //POI的名称
      "snippet": "" //POI的地址
      "longitude": 11.11, //该点经度
      "latitude": 11.11, //该点纬度
      }
  */</span>
  <span class="p">},</span>
  <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>province</td>
<td>省份</td>
</tr>
<tr>
<td>provinceCode</td>
<td>省份编码</td>
</tr>
<tr>
<td>city</td>
<td>城市</td>
</tr>
<tr>
<td>cityCode</td>
<td>城市编码</td>
</tr>
<tr>
<td>adCode</td>
<td>POI的行政区划代码</td>
</tr>
<tr>
<td>adName</td>
<td>POI的行政区划名称</td>
</tr>
<tr>
<td>distance</td>
<td>获取POI距离中心点的距离</td>
</tr>
<tr>
<td>postCode</td>
<td>返回POI的邮编</td>
</tr>
<tr>
<td>title</td>
<td>POI的名称</td>
</tr>
<tr>
<td>snippet</td>
<td>POI的地址</td>
</tr>
<tr>
<td>longitude</td>
<td>该点经度</td>
</tr>
<tr>
<td>latitude</td>
<td>该点纬度</td>
</tr>
</tbody></table>

<h2 id="加速器">加速器</h2>

<p>dd.device</p>

<h3 id="摇一摇">摇一摇</h3>

<p>开启监听</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">accelerometer</span><span class="p">.</span><span class="nx">watchShake</span><span class="p">({</span>
    <span class="na">sensitivity</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span><span class="c1">//振动幅度，Number类型，加速度变化超过这个值后触发shake</span>
    <span class="na">frequency</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span><span class="c1">//采样间隔(毫秒)，Number类型，指每隔多长时间对加速度进行一次采样， 然后对比前后变化，判断是否触发shake</span>
    <span class="na">callbackDelay</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span><span class="c1">//触发『摇一摇』后的等待时间(毫秒)，Number类型，防止频繁调用</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>sensitivity</td>
<td>Number</td>
<td>振动幅度，Number类型，加速度变化超过这个值后触发shake</td>
</tr>
<tr>
<td>frequency</td>
<td>Number</td>
<td>采样间隔(毫秒)，Number类型，指每隔多长时间对加速度进行一次采样， 然后对比前后变化，判断是否触发shake</td>
</tr>
<tr>
<td>callbackDelay</td>
<td>Number</td>
<td>触发『摇一摇』后的等待时间(毫秒)，Number类型，防止频繁调用</td>
</tr>
</tbody></table>

<p>清除监听</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">accelerometer</span><span class="p">.</span><span class="nx">clearShake</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/* 调用成功
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h2 id="业务">业务</h2>

<p>dd.biz</p>

<h3 id="功能">功能</h3>

<h4 id="打开应用内页面">打开应用内页面</h4>

<p>目前支持打开邮箱附件和打开聊天页面，</p>

<p>a.邮箱附件</p>
<pre class="highlight plaintext"><code>// 页面名称：
    mailAttachment
// 传参：
    mailId: String
    attachmentId: String
    title: String
    size: Number
</code></pre>

<p>b.个人资料页</p>
<pre class="highlight plaintext"><code>// 页面名称：
    profile
// 传参：
    id 用户工号 String
    corpId: '' //企业id
</code></pre>

<p>c.聊天页面</p>
<pre class="highlight plaintext"><code>// 页面名称：
    chat
// 传参：
    users: ['123'] 用户列表,工号
    corpId: '' //企业id
</code></pre>

<p>d.免费电话页面</p>
<pre class="highlight plaintext"><code>// 页面名称：
    call
// 传参：
</code></pre>

<p>f.联系人添加页面</p>

<p>0.0.4</p>
<pre class="highlight plaintext"><code>// 页面名称：
    contactAdd
// 传参：
</code></pre>

<p>g.唤起添加好友页面</p>

<p>0.0.4</p>
<pre class="highlight plaintext"><code>// 页面名称：
    friendAdd
// 传参：
</code></pre>

<h4 id="打开远程url">打开远程url</h4>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">openLink</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">showMenuBar</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">//是否显示右上角按钮，默认true 显示 0.0.2</span>
    <span class="na">credible</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">//是否可信的url，即白名单机制，可信的url支持调用jsapi，默认true 0.0.2</span>
    <span class="na">enableShare</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">//是否启用默认分享(服务端抓取内容)，如果为false，则分享组件只有刷新动作; 默认true</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>String</td>
<td>远程url</td>
</tr>
<tr>
<td>showMenuBar</td>
<td>Boolean</td>
<td>是否显示右上角按钮，默认true 显示 0.0.2</td>
</tr>
<tr>
<td>credible</td>
<td>Boolean</td>
<td>是否可信的url，即白名单机制，可信的url支持调用jsapi，默认true 0.0.2</td>
</tr>
<tr>
<td>enableShare</td>
<td>Boolean</td>
<td>是否启用默认分享(服务端抓取内容)，如果为false，则分享组件只有刷新动作; 默认true</td>
</tr>
</tbody></table>

<h4 id="分享">分享</h4>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">share</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span><span class="c1">//分享类型，0:全部组件 默认； 1:只能分享到钉钉；2:不能分享，只有刷新按钮</span>
    <span class="na">url</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">content</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">image</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>Number</td>
<td>分享类型，0:全部组件默认； 1:只能分享到钉钉；2:不能分享，只有刷新按钮</td>
</tr>
<tr>
<td>url</td>
<td>String</td>
<td>url地址</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>分享标题</td>
</tr>
<tr>
<td>content</td>
<td>String</td>
<td>分享内容</td>
</tr>
<tr>
<td>image</td>
<td>String</td>
<td>分享的图片</td>
</tr>
</tbody></table>

<h4 id="ut打点">ut打点</h4>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">ut</span><span class="p">({</span>
    <span class="na">key</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//打点名</span>
    <span class="na">value</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//打点传值</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>String</td>
<td>打点名</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>打点传值</td>
</tr>
</tbody></table>

<!--### 选取图片[暂不开放]

```javascript
dd.biz.util.chooseImage({
    multiple: false, //是否多选，默认false
    destType: String, //返回格式 DATA_URL(base64编码) FILE_URI(文件路径)，默认FILE_URI
    onSuccess : function(result) {
        /**/
    },
    onFail : function() {}
})
```
-->

<h4 id="上传图片">上传图片</h4>

<p>选择图片+上传，防止恶意上传</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">uploadImage</span><span class="p">({</span>
    <span class="na">multiple</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">//是否多选，默认false</span>
    <span class="na">max</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">//最多可选个数</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        [
          'http://gtms03.alicdn.com/tps/i3/TB1VF6uGFXXXXalaXXXmh5R_VXX-237-236.png'
        ]
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>multiple</td>
<td>Boolean</td>
<td>是否多选，默认false</td>
</tr>
<tr>
<td>max</td>
<td>Number</td>
<td>Number为正整数，最多可选个数</td>
</tr>
</tbody></table>

<h4 id="图片浏览器">图片浏览器</h4>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">previewImage</span><span class="p">({</span>
    <span class="na">urls</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">],</span><span class="c1">//图片地址列表</span>
    <span class="na">current</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//当前显示的图片链接</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>urls</td>
<td>Array[String]</td>
<td>图片地址列表</td>
</tr>
<tr>
<td>current</td>
<td>String</td>
<td>当前显示的图片链接</td>
</tr>
</tbody></table>

<h4 id="扫码">扫码</h4>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">qrcode</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            text: String
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>扫码的内容</td>
</tr>
</tbody></table>

<h4 id="日期选择器">日期选择器</h4>

<p>日期</p>

<p>注意：format只支持android系统规范，即2015-03-31格式为yyyy-MM-dd</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">({</span>
    <span class="na">format</span><span class="p">:</span> <span class="s1">'yyyy-MM-dd'</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="s1">'2015-04-17'</span><span class="p">,</span> <span class="c1">//默认显示日期</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            value: "2015-02-10"
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>format</td>
<td>String</td>
<td>format只支持android系统规范，即2015-03-31格式为yyyy-MM-dd</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>默认显示日期</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>返回选择的日期</td>
</tr>
</tbody></table>

<p>时间</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">timepicker</span><span class="p">({</span>
    <span class="na">format</span><span class="p">:</span> <span class="s1">'HH:mm'</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="s1">'14:00'</span><span class="p">,</span> <span class="c1">//默认显示时间  0.0.3</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            value: "10:00"
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>format</td>
<td>String</td>
<td>时间格式</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>默认显示时间</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>返回选择的时间</td>
</tr>
</tbody></table>

<p>日期+时间</p>

<p>0.0.4</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">datetimepicker</span><span class="p">({</span>
    <span class="na">format</span><span class="p">:</span> <span class="s1">'yyyy-MM-dd HH:mm'</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="s1">'2015-04-17 08:00'</span><span class="p">,</span> <span class="c1">//默认显示</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            value: "2015-06-10 09:50"
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>format</td>
<td>String</td>
<td>日期和时间的格式</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>默认显示的日期和时间</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>返回选择的日期和时间</td>
</tr>
</tbody></table>

<h3 id="下拉控件">下拉控件</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">chosen</span><span class="p">({</span>
    <span class="na">source</span><span class="p">:[{</span>
        <span class="na">key</span><span class="p">:</span> <span class="s1">'选项1'</span><span class="p">,</span> <span class="c1">//显示文本</span>
        <span class="na">value</span><span class="p">:</span> <span class="mi">123</span> <span class="c1">//值，</span>
    <span class="p">},{</span>
        <span class="na">key</span><span class="p">:</span> <span class="s1">'选项2'</span><span class="p">,</span>
        <span class="na">value</span><span class="p">:</span> <span class="mi">234</span>
    <span class="p">}],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            key: '选项2',
            value: 234
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>Array[String]</td>
<td>下拉控件的内容</td>
</tr>
<tr>
<td>key</td>
<td>String</td>
<td>显示文本</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>文本对应的值</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>返回选择的文本</td>
</tr>
<tr>
<td>value</td>
<td>返回选择的值</td>
</tr>
</tbody></table>

<!--## 聊天

dd.biz

### 发送消息

```javascript
dd.biz.chat.sendMessage({
    users : ['100', '101'],//用户列表，工号
    corpId: '', //企业id
    type: 1,//消息类型 1：image  2：link  [暂定和发钉保持一致]
    attachment: {
        images: [''],
    },
    text: String,
    onSuccess : function() {},
    onFail : function() {}
})
```

### 选择会话(群)

类似分享到钉钉的选取页面，只能选一个回话 0.0.3

```javascript
dd.biz.chat.chooseConversation({
    onSuccess : function(data) {
    /*
    {
        id: '123' //会话id
    }
    */
    },
    onFail : function() {}
})
```
#####　返回说明
参数 | 说明
----- | ------
id | 会话id

###获取会话信息

0.0.6

```javascript
dd.biz.chat.getConversationInfo ({
  cid: String, //会话ID
  onSuccess: function(data) {
  /* data结构
      "cid": "1111", //会话ID
      "title": '123', //会话标题
      "avatarIcons": ["http://", ...], //会话的头像数组
      "memberCount": 11, //群聊成员总数
      }
  */
  },
  onFail : function(err) {
  }
})
```
##### 参数说明

参数 | 参数类型 | 说明
----- | ----- | -----
cid | String | 会话ID

##### 返回说明
参数 | 说明
----- | -----
cid | 会话ID
title | 会话标题
avatarIcons | 会话的头像数组
memberCount | 群聊成员总数
-->

<h2 id="ding">Ding</h2>

<p>dd.biz</p>

<h3 id="发钉">发钉</h3>

<h4 id="图片类型">图片类型</h4>

<p>0.0.3</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">ding</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
    <span class="na">users</span> <span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span> <span class="s1">'101'</span><span class="p">],</span><span class="c1">//用户列表，工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">type</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">//钉类型 1：image  2：link</span>
    <span class="na">attachment</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">images</span><span class="p">:</span> <span class="p">[</span><span class="s1">''</span><span class="p">],</span>
    <span class="p">},</span> <span class="c1">//附件信息</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//消息</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>用户列表，工号</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>type</td>
<td>Number</td>
<td>Number为整数。钉类型 1：image，2：link</td>
</tr>
<tr>
<td>attachment</td>
<td>Object</td>
<td>附件信息</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>消息</td>
</tr>
</tbody></table>

<h4 id="link类型">Link类型</h4>

<p>0.0.3</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">ding</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
    <span class="na">users</span> <span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span> <span class="s1">'101'</span><span class="p">],</span><span class="c1">//用户列表，工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">type</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="c1">//钉类型 1：image  2：link</span>
    <span class="na">attachment</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
        <span class="na">image</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">''</span>
    <span class="p">}</span>
    <span class="nl">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//消息</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>用户列表，工号</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>type</td>
<td>Number</td>
<td>Number为整数。钉类型 1：image  2：link</td>
</tr>
<tr>
<td>attachment</td>
<td>Object</td>
<td>附件信息</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>消息</td>
</tr>
</tbody></table>

<h2 id="电话">电话</h2>

<p>dd.biz</p>

<h3 id="打电话">打电话</h3>

<p>0.0.3</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">telephone</span><span class="p">.</span><span class="nx">call</span><span class="p">({</span>
    <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="s1">'101'</span><span class="p">,</span> <span class="s1">'102'</span><span class="p">],</span> <span class="c1">//用户列表，工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>用户列表，工号</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
</tbody></table>

<h2 id="ui控件">UI控件</h2>

<p>dd.ui</p>

<h3 id="输入框">输入框</h3>

<p>0.0.2</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">plain</span><span class="p">({</span>
    <span class="na">placeholder</span><span class="p">:</span> <span class="s1">'说点什么吧'</span><span class="p">,</span> <span class="c1">//占位符</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//默认填充文本</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            text: String
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>placeholder</td>
<td>String</td>
<td>占位符</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>默认填充文本</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>返回文本</td>
</tr>
</tbody></table>

<h3 id="设置顶部进度条颜色">设置顶部进度条颜色</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">progressBar</span><span class="p">.</span><span class="nx">setColors</span><span class="p">({</span>
    <span class="na">colors</span><span class="p">:</span> <span class="p">[],</span> <span class="c1">//array[number] 进度条变化颜色，最多支持4个颜色</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
            true:成功  false:失败
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>colors</td>
<td>array[number]</td>
<td>进度条变化颜色，最多支持4个颜色</td>
</tr>
</tbody></table>

<h3 id="启用下拉刷新">启用下拉刷新</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">pullToRefresh</span><span class="p">.</span><span class="nx">enable</span><span class="p">({</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//alert('下拉刷新')</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h3 id="收起下拉loading">收起下拉loading</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">pullToRefresh</span><span class="p">.</span><span class="nx">stop</span><span class="p">()</span>
</code></pre>

<h3 id="禁用下拉刷新">禁用下拉刷新</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">pullToRefresh</span><span class="p">.</span><span class="nx">disable</span><span class="p">()</span>
</code></pre>

<h3 id="启用bounce">启用bounce</h3>

<p>启用iOS webview弹性效果 0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">webViewBounce</span><span class="p">.</span><span class="nx">enable</span><span class="p">()</span>
</code></pre>

<h3 id="禁用bounce">禁用bounce</h3>

<p>禁用iOS webview弹性效果 0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">webViewBounce</span><span class="p">.</span><span class="nx">disable</span><span class="p">()</span>
</code></pre>

<h2 id="扫码">扫码</h2>

<p>dd.biz</p>

<p>0.0.6</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">scan</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//type为qrCode或者barCode</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="cm">/* data结构
        { 'text': String}
      */</span>
    <span class="p">},</span>
   <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
   <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>String</td>
<td>type为qrCode或者barCode</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>扫码内容</td>
</tr>
</tbody></table>

<h2 id="企业通讯录">企业通讯录</h2>

<p>dd.biz</p>

<h3 id="选人">选人</h3>

<p>0.0.6</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">contact</span><span class="p">.</span><span class="nx">choose</span><span class="p">({</span>
  <span class="na">multiple</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span> <span class="c1">//是否多选： true多选 false单选； 默认true</span>
  <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="nb">Number</span><span class="p">,</span> <span class="nb">Number</span><span class="p">,</span> <span class="p">...],</span> <span class="c1">//默认选中的用户列表，工号；成功回调中应包含该信息</span>
  <span class="na">corpId</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="c1">//企业id</span>
  <span class="na">max</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//人数限制，当multiple为true才生效，可选范围1-1500</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="cm">/* data结构
    [{
      "name": "张三", //姓名
      "avatar": "http://g.alicdn.com/avatar/zhangsan.png" //头像图片url，可能为空
      "emplId": '0573', //工号
     },
     ...
    ]
  */</span>
  <span class="p">},</span>
  <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>multiple</td>
<td>Boolean</td>
<td>是否多选： true多选，false单选； 默认true</td>
</tr>
<tr>
<td>users</td>
<td>Array[Number]</td>
<td>默认选中的用户列表，工号；成功回调中应包含该信息</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>max</td>
<td>Number</td>
<td>人数限制，当multiple为true才生效，可选范围1-1500</td>
</tr>
</tbody></table>

<!--
startWithDepartmentId: Number, //-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)
startWithDepartmentId | Number | -1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)
-->

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>姓名</td>
</tr>
<tr>
<td>avatar</td>
<td>头像图片url，可能为空</td>
</tr>
<tr>
<td>emplId</td>
<td>工号</td>
</tr>
</tbody></table>

<h3 id="选人，选部门">选人，选部门</h3>

<p>0.0.6</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">contact</span><span class="p">.</span><span class="nx">complexChoose</span><span class="p">({</span>
  <span class="na">startWithDepartmentId</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)</span>
  <span class="na">selectedUsers</span><span class="p">:</span> <span class="p">[</span><span class="nb">Number</span><span class="p">,</span> <span class="nb">Number</span><span class="p">,</span> <span class="p">...],</span> <span class="c1">//预选用户</span>
  <span class="na">corpId</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="c1">//企业id</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="cm">/* data结构
    {
      "users": [
      {
        "name": "张三", //姓名
        "avatar": "htp://g.alicdn.com/avatar/zhangsan.png" //头像图片url，可能为空
        "emplId": "0573", //工号:
      },
      ...
      ],
      "department": [
      {
        "id": 2,
        "name": "来往事业部",
      },
      ...
      ]
    }
  */</span>
  <span class="p">},</span>
  <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>startWithDepartmentId</td>
<td>Number</td>
<td>-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)</td>
</tr>
<tr>
<td>selectedUsers</td>
<td>Array[Number]</td>
<td>预选用户</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
</tbody></table>

<!--隐藏selectedDepartments
selectedDepartments | Array | 预选部门 id必选，name可选
selectedDepartments: [{name: '', id: ''}, ...],//预选部门 id必选，name可选
-->

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>选取的用户</td>
</tr>
<tr>
<td>users.name</td>
<td>姓名</td>
</tr>
<tr>
<td>users.avatar</td>
<td>头像图片url，可能为空</td>
</tr>
<tr>
<td>users.emplId</td>
<td>工号</td>
</tr>
<tr>
<td>department</td>
<td>选取的部门</td>
</tr>
<tr>
<td>department.id</td>
<td>部门id</td>
</tr>
<tr>
<td>department.name</td>
<td>部门名称</td>
</tr>
</tbody></table>

<h3 id="选取">选取</h3>

<p>默认展示当前  业通讯录，开发中</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">contact</span><span class="p">.</span><span class="nx">choose</span><span class="p">({</span>
    <span class="na">multiple</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">//是否多选： true多选 false单选； 默认true</span>
    <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span><span class="s1">'101'</span><span class="p">],</span> <span class="c1">//默认选中的用户列表，工号；成功回调中应包含该信息</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">max</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="c1">//人数限制，当multiple为true才生效，可选范围1-1500</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        [{
            emplId: '0573', //工号
            name: '张三', //姓名
            nickNameCn: '三张', //花名
            mobilePhone: '****', //手机号 后续不再返回该字段
            emailAddr: '***', //邮箱  后期不再返回该字段
            pinyin: 'zhangsan', //姓名拼音
            avatar: 'htp://g.alicdn.com/avatar/zhangsan.png' //头像图片url，可能为空
        }]
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>multiple</td>
<td>Boolean</td>
<td>是否多选： true多选 false单选； 默认true</td>
</tr>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>默认选中的用户列表，工号；成功回调中应包含该信息</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>max</td>
<td>Number</td>
<td>Number为正整数。人数限制，当multiple为true才生效，可选范围1-1500</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>emplID</td>
<td>是否多选： true多选 false单选； 默认true</td>
</tr>
<tr>
<td>name</td>
<td>姓名</td>
</tr>
<tr>
<td>nickNameCn</td>
<td>花名</td>
</tr>
<tr>
<td>mobilePhone</td>
<td>手机号，后续不再返回该字段</td>
</tr>
<tr>
<td>emailAddr</td>
<td>邮箱，后期不再返回该字段</td>
</tr>
<tr>
<td>pinyin</td>
<td>姓名拼音</td>
</tr>
<tr>
<td>avatar</td>
<td>头像图片url，可能为空</td>
</tr>
</tbody></table>

<h3 id="创建企业群聊天">创建企业群聊天</h3>

<p>0.0.4</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">contact</span><span class="p">.</span><span class="nx">createGroup</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id，可选，配置该参数即在指定企业创建群聊天</span>
    <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span><span class="s1">'101'</span><span class="p">],</span> <span class="c1">//默认选中的用户工号列表，可选；使用此参数必须指定corpId</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            id: 123   //企业群id
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id，可选，配置该参数即在指定企业创建群聊天</td>
</tr>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>默认选中的用户列表，可选；使用此参数必须指定corpId</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>企业群id</td>
</tr>
</tbody></table>

<!--### 添加好友

```javascript
dd.biz.contact.addFriend({
    onSuccess: function(result) {
        /*{
            id: 123   //企业群id
        }*/
    },
    onFail: function(err) {
    }
})
```
-->

<!--## 用户

### 获取当前用户信息

目前只开放emplId字段

```javascript
dd.biz.user.get({
    onSuccess : function(result) {
        /*
        {
            id: '112', //id
            emplId: '0573' //工号
        }
        */
    },
    onFail : function(err) {}
});
```
-->

<h2 id="导航栏">导航栏</h2>

<p>dd.biz</p>

<h3 id="设置左侧导航按钮">设置左侧导航按钮</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setLeft</span><span class="p">({</span>
    <span class="na">show</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span><span class="c1">//控制按钮显示， true 显示， false 隐藏， 默认true</span>
    <span class="na">control</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否控制点击事件，true 控制，false 不控制， 默认false</span>
    <span class="na">showIcon</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否显示icon，true 显示， false 不显示，默认true； 注：具体UI以客户端为准</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span><span class="c1">//控制显示文本，空字符串表示显示默认文本或icon</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>show</td>
<td>Boolean</td>
<td>控制按钮显示， true 显示， false 隐藏， 默认true</td>
</tr>
<tr>
<td>control</td>
<td>Boolean</td>
<td>是否控制点击事件，true 控制，false 不控制， 默认false</td>
</tr>
<tr>
<td>showIcon</td>
<td>Boolean</td>
<td>是否显示icon，true 显示，false 不显示，默认true； 注：具体UI以客户端为准</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>控制显示文本，空字符串表示显示默认文本或icon</td>
</tr>
</tbody></table>

<h3 id="设置右侧导航按钮">设置右侧导航按钮</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setRight</span><span class="p">({</span>
    <span class="na">show</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span><span class="c1">//控制按钮显示， true 显示， false 隐藏， 默认true</span>
    <span class="na">control</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否控制点击事件，true 控制，false 不控制， 默认false</span>
    <span class="na">showIcon</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否显示icon，true 显示， false 不显示，默认true； 注：具体UI以客户端为准</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'发送'</span><span class="p">,</span><span class="c1">//控制显示文本，空字符串表示显示默认文本或icon</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>show</td>
<td>Boolean</td>
<td>控制按钮显示， true 显示， false 隐藏， 默认true</td>
</tr>
<tr>
<td>control</td>
<td>Boolean</td>
<td>是否控制点击事件，true 控制，false 不控制， 默认false</td>
</tr>
<tr>
<td>showIcon</td>
<td>Boolean</td>
<td>是否显示icon，true 显示，false 不显示，默认true； 注：具体UI以客户端为准</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>控制显示文本，空字符串表示显示默认文本或icon</td>
</tr>
</tbody></table>

<p>可通过拼接url方式隐藏 showmenu=false</p>

<h3 id="设置标题">设置标题</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setTitle</span><span class="p">({</span>
    <span class="na">title</span><span class="p">:</span> <span class="s1">'邮箱正文'</span><span class="p">,</span><span class="c1">//控制标题文本，空字符串表示显示默认文本</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*结构
        {
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>String</td>
<td>控制标题文本，空字符串表示显示默认文本</td>
</tr>
</tbody></table>

<h3 id="触发后退">触发后退</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">back</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*result结构
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h2 id="附录">附录</h2>

<h3 id="js-api权限签名算法">JS-API权限签名算法</h3>

<p>如果开发者想使用钉钉容器开放的jsapi接口，需要经过以下流程：</p>

<ul>
<li><p>首先需要以<a href="http://open.dingtalk.com/#建立连接">获取到的access_token</a>作为参数,获取jsapi_ticket。</p></li>
<li><p>然后在web页面加载到钉钉容器时，通过<a href="http://open.dingtalk.com/#页面引入js文件">jsapi权限验证配置接口</a>验证可用的jsapi。这个接口使用的参数signature，在下文中有详细的说明。</p></li>
</ul>

<h4 id="1-获取jsapi_ticket">1.获取jsapi_ticket</h4>

<p>jsapi_ticket,是开发者调用钉钉JS接口的临时授权码，其作用主要用于生成签名，这个签名在<a href="http://open.dingtalk.com/#页面引入js文件">jsapi权限验证配置接口</a>中使用。</p>

<p>正常的情况下，jsapi_ticket的有效期为7200秒，通过access_token来获取。由于频繁刷新jsapi_ticket会导致api调用受限，影响自身业务，开发者必须在自己的服务全局缓存jsapi_ticket。
获取jsapi_ticket，具体可以<a href="http://open.dingtalk.com/#js接口api">参考文档</a></p>

<h4 id="2-签名生成算法">2.签名生成算法</h4>

<p>开发者在web页面使用钉钉容器提供的jsapi时，需要验证调用权限，并以参数signature标识合法性</p>

<p>签名生成的规则：</p>

<p>List keyArray = sort(noncestr,timestamp,jsapi_ticket,url);</p>

<p>String str = assemble(keyArray);</p>

<p>signature = sha1(str);</p>

<p>参与签名的字段包括在上文中获取的jsapi_ticket，noncestr（随机字符串）,timestamp（时间戳）,url（当前网页的URL，不包含#及其后面部分）。</p>

<ul>
<li>noncestr=Zn4zmLFKD0wzilzM</li>
<li>jsapi_ticket=mS5k98fdkdgDKxkXGEs8LORVREiweeWETE40P37wkidkfksDSKDJFD5h9nbSlYy3-Sl-HhTdfl2fzFy1AOcKIDU8l</li>
<li>timestamp=1414588745</li>
<li>url=http://open.dingtalk.com</li>
</ul>

<p>步骤1. sort()含义为对所有待签名参数按照字段名的ASCII 码从小到大排序（字典序）</p>

<p>步骤2. assemble()含义为根据步骤1中获的参数字段的顺序，使用URL键值对的格式（即key1=value1&amp;key2=value2…）拼接成字符串</p>

<p>步骤2. sha1()的含义为对在步骤2拼接好的字符串进行sha1加密。</p>

<h3 id="图片缩放">图片缩放</h3>

<p>通过JS-API获取的图片都支持缩放，比如图片：</p>

<p><code class="prettyprint">http://gtms02.alicdn.com/tps/i2/TB1SlYwGFXXXXXrXVXX9vKJ2XXX-2880-1560.jpg</code></p>

<p>可通过文件名拼接的方法缩放为最大宽高为250x250的尺寸。</p>

<p><code class="prettyprint">http://gtms02.alicdn.com/tps/i2/TB1SlYwGFXXXXXrXVXX9vKJ2XXX-2880-1560.jpg_250x250.jpg</code></p>

<p>拼接规则为:文件名+拼接规则；推荐使用以下拼接规则：</p>

<p>80x80 =&gt; _80x80.jpg</p>

<p>120x120 =&gt; _120x120.jpg</p>

<p>250x250 =&gt; _250x250.jpg</p>

<p>310x310 =&gt; _310x310.jpg</p>

<h3 id="容器能力">容器能力</h3>

<p><a href="#alert">device.notification.alert</a></p>

<p><a href="#confirm">device.notification.confirm</a></p>

<p><a href="#prompt">device.notification.prompt</a></p>

<p><a href="#vibrate">device.notification.vibrate</a></p>

<p><a href="#摇一摇">device.accelerometer.watchShake</a></p>

<p><a href="#摇一摇">device.accelerometer.clearShake</a></p>

<p><a href="#打开应用内页面">biz.util.open</a></p>

<p><a href="#打开远程url">biz.util.openLink</a></p>

<p><a href="#分享">biz.util.share</a></p>

<p><a href="#ut打点">biz.util.ut</a></p>

<p><a href="#日期选择器">biz.util.datepicker</a> //android</p>

<p><a href="#日期选择器">biz.util.timepicker</a> //android</p>

<p><a href="#选取">biz.contact.choose</a></p>

<!--
[biz.user.get](#get)
-->

<p><a href="#设置左侧导航按钮">biz.navigation.setLeft</a></p>

<p><a href="#设置右侧导航按钮">biz.navigation.setRight</a></p>

<p><a href="#设置标题">biz.navigation.setTitle</a></p>

<p><a href="#触发后退">biz.navigation.back</a></p>

<p>// v0.0.1</p>

<p><a href="#toast">device.notification.toast</a></p>

<p><a href="#showPreloader">device.notification.showPreloader</a></p>

<p><a href="#hidePreloader">device.notification.hidePreloader</a></p>

<p><a href="#get">device.geolocation.get</a></p>

<p><a href="#上传图片">biz.util.uploadImage</a></p>

<p><a href="#图片浏览器">biz.util.previewImage</a></p>

<p>//v0.0.2</p>

<p><a href="#输入框">ui.input.plain</a></p>

<p><a href="#actionSheet">device.notification.actionSheet</a></p>

<p><a href="#扫码">biz.util.qrcode</a></p>

<p><a href="#获取当前网络类型">device.connection.getNetworkType</a></p>

<p><a href="#info">runtime.info</a></p>

<p>//v0.0.3</p>

<p><a href="#发钉">biz.ding.post</a></p>

<p><a href="#打电话">biz.telephone.call</a></p>

<p><a href="#选择会话_群">biz.chat.chooseConversation</a></p>

<p>//v0.0.4</p>

<p><a href="#创建企业群聊天">biz.contact.createGroup</a></p>

<p><a href="#日期选择器">biz.util.datetimepicker</a></p>

<p>//v0.0.5</p>

<p><a href="#下拉控件">biz.util.chosen</a></p>

<p><a href="#获取设备唯一识别码">device.base.getUUID</a></p>

<p><a href="#获取热点接入信息">device.base.getInterface</a></p>

<p><a href="#检测应用是否安装">device.launcher.checkInstalledApps</a></p>

<p><a href="#启动第三方应用">device.launcher.launchApp</a></p>

<p><a href="#setRefreshing">ui.progressBar.setRefreshing</a></p>

<p><a href="#设置顶部进度条颜色">ui.progressBar.setColors</a></p>

<p><a href="#请求授权码">runtime.permission.requestAuthCode</a></p>

<p><a href="#请求jsapi">runtime.permission.requestJsApis</a></p>

<p><a href="#启用下拉刷新">ui.pullToRefresh.enable</a></p>

<p><a href="#收起下拉loading">ui.pullToRefresh.stop</a></p>

<p><a href="#禁用下拉刷新">ui.pullToRefresh.disable</a></p>

<p><a href="#启用bounce">ui.webViewBounce.enable</a></p>

<p><a href="#启用bounce">ui.webViewBounce.disable</a></p>

<h2 id="demo">Demo</h2>

<h4 id="demo地址：-http-h5-m-laiwang-com-home-ding-html"><a href="http://h5.m.laiwang.com/home/ding.html">Demo地址：</a> <code class="prettyprint">http://h5.m.laiwang.com/home/ding.html</code></h4>

          <h1 id="cdn服务哈哈啊哈哈哈哈">CDN服务哈哈啊哈哈哈哈</h1>

<p>钉钉开放平台为常用的js库提供了CDN加速服务，这样做不仅可以为您节省流量，还可以获得更快的访问速度。</p>

<h2 id="backbone">backbone</h2>

<p><a href="http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone-min.js">http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone-min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone.js">http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone.js</a></p>

<h2 id="jquery">jquery</h2>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.min.js">http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.js">http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.min.js">http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.js">http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.js</a></p>

<h2 id="underscore">underscore</h2>

<p><a href="http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore-min.js">http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore-min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore.js">http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore.js</a></p>

<h2 id="zepto">zepto</h2>

<p><a href="http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.min.js">http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.js">http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.js</a></p>

          <h1 id="faq">FAQ</h1>

<h2 id="q-从哪里可以获得corpid和corpsecret">Q:从哪里可以获得CorpID和CorpSecret?</h2>

<p>A:在钉钉管理后台的微应用设置页面可以获取，详细方法请参见<a href="http://open.dingtalk.com/#获取corpid和corpsecret">《接入指南-获取CorpID和CorpSecret》</a>。</p>

<h2 id="q-调用管理通讯录接口返回430004，无效的http-header-content-type如何解决？">Q:调用管理通讯录接口返回430004，无效的HTTP HEADER Content-Type如何解决？</h2>

<p>A:管理通讯录的部分接口采用了POST请求，请求体使用JSON格式，请在HTTP请求头中设置Content-Type:application/json。</p>

<h2 id="q-开发遇到困难怎样反馈给你们">Q:开发遇到困难怎样反馈给你们?</h2>

<p>A:我们目前在阿里云开发者论坛开放了一个<a href="http://bbs.aliyun.com/thread/276.html?spm=5176.7189909.0.0.bq46VP">钉钉开放平台</a>模块，你可以按照以下格式发帖到这个模块，我们会定期搜集和解决。</p>

<p>请编辑如下信息，发到群里面，这样便于快速解决问题。</p>

<table><thead>
<tr>
<th>企业完整名称</th>
<th>例如 阿里巴巴</th>
</tr>
</thead><tbody>
<tr>
<td>访问接口的全路径</td>
<td>例如 https://oapi.dingtalk.com/gettoken</td>
</tr>
<tr>
<td>输入参数</td>
<td>AccessToken及CorpId、CorpSecret不需要提供</td>
</tr>
<tr>
<td>发起请求的服务器的外网IP地址</td>
<td></td>
</tr>
<tr>
<td>发起请求的时间点</td>
<td>例如 2015-6-16 10:03:50</td>
</tr>
<tr>
<td>返回的错误结果</td>
<td>例如 系统繁忙</td>
</tr>
</tbody></table>

<p>若你急需找到我们请联系业内同事朋友在钉钉上加入&ldquo;钉钉开放平台官方技术答疑群&quot;进行反馈。</p>

      </div>
    </div
  </body>
</html>
